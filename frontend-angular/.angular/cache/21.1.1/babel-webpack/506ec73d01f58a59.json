{"ast":null,"code":"import _asyncToGenerator from \"/home/dfirth2/fiber_route_calculator/frontend-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = [\"pdfCanvas\"];\nconst _c1 = [\"wrapper\"];\nconst _c2 = [\"overlayCanvas\"];\nfunction PDFViewerComponent_div_23_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function PDFViewerComponent_div_23_button_3_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      ctx_r2.clearCalibration();\n      return i0.ɵɵresetView(ctx_r2.showCalibrationMenu = false);\n    });\n    i0.ɵɵtext(1, \"Reset\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PDFViewerComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function PDFViewerComponent_div_23_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      ctx_r2.setMode(\"calibrate\");\n      return i0.ɵɵresetView(ctx_r2.showCalibrationMenu = false);\n    });\n    i0.ɵɵtext(2, \"Calibrate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, PDFViewerComponent_div_23_button_3_Template, 2, 0, \"button\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"bg-blue-600\", ctx_r2.mode === \"calibrate\")(\"text-white\", ctx_r2.mode === \"calibrate\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.scaleFeetPerPixel);\n  }\n}\nfunction PDFViewerComponent_button_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function PDFViewerComponent_button_26_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.saveFiber());\n    });\n    i0.ɵɵtext(1, \"Save Fiber\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PDFViewerComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function PDFViewerComponent_div_30_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r2 = i0.ɵɵnextContext();\n      ctx_r2.setMode(\"terminal\");\n      return i0.ɵɵresetView(ctx_r2.showEquipmentMenu = false);\n    });\n    i0.ɵɵtext(2, \"Terminal\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function PDFViewerComponent_div_30_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r2 = i0.ɵɵnextContext();\n      ctx_r2.setMode(\"drop\");\n      return i0.ɵɵresetView(ctx_r2.showEquipmentMenu = false);\n    });\n    i0.ɵɵtext(4, \"Drop Pedestal\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function PDFViewerComponent_div_30_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r2 = i0.ɵɵnextContext();\n      ctx_r2.setMode(\"conduit\");\n      return i0.ɵɵresetView(ctx_r2.showEquipmentMenu = false);\n    });\n    i0.ɵɵtext(6, \"Conduit\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"bg-blue-600\", ctx_r2.mode === \"terminal\")(\"text-white\", ctx_r2.mode === \"terminal\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"bg-blue-600\", ctx_r2.mode === \"drop\")(\"text-white\", ctx_r2.mode === \"drop\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"bg-blue-600\", ctx_r2.mode === \"conduit\")(\"text-white\", ctx_r2.mode === \"conduit\");\n  }\n}\nfunction PDFViewerComponent_div_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Calibrate: click two points on scale, enter real feet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PDFViewerComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"Scale: \", (ctx_r2.scaleFeetPerPixel * 12).toFixed(4), \" inches/px (\", ctx_r2.scaleFeetPerPixel.toFixed(4), \" ft/px)\");\n  }\n}\nfunction PDFViewerComponent_div_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.toastMessage, \" \");\n  }\n}\npdfjsLib.GlobalWorkerOptions.workerSrc = '/assets/pdf.worker.min.mjs';\nexport class PDFViewerComponent {\n  constructor() {\n    this.pdfUrl = '';\n    this.pdf = null;\n    this.currentPage = 1;\n    this.zoom = 1;\n    this.panOffset = {\n      x: 0,\n      y: 0\n    };\n    this.isPanning = false;\n    this.Math = Math;\n    this.mode = 'pan';\n    this.calibrationPoints = [];\n    this.scaleFeetPerPixel = null;\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.polylines = [];\n    this.totalLengthFeet = 0;\n    this.totalConduitFeet = 0;\n    this.terminals = [];\n    this.drops = [];\n    this.selectedEndpoint = null;\n    this.toastMessage = null;\n    this.showEquipmentMenu = false;\n    this.showCalibrationMenu = false;\n    this.toastTimer = null;\n    this.renderTask = null;\n    this.lastMouse = {\n      x: 0,\n      y: 0\n    };\n    this.overlayCtx = null;\n    this.polylinesChanged = new EventEmitter();\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (_this.pdfUrl) {\n        yield _this.loadPdf();\n      }\n    })();\n  }\n  ngOnChanges(changes) {\n    if (changes['pdfUrl'] && !changes['pdfUrl'].firstChange && this.pdfUrl) {\n      this.loadPdf();\n    }\n  }\n  loadPdf() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this2.pdfUrl) return;\n      try {\n        const response = yield fetch(_this2.pdfUrl);\n        if (!response.ok) {\n          console.error('Failed to fetch PDF:', response.status, response.statusText);\n          return;\n        }\n        const blob = yield response.blob();\n        const buffer = yield blob.arrayBuffer();\n        const typedArray = new Uint8Array(buffer);\n        _this2.pdf = yield pdfjsLib.getDocument({\n          data: typedArray\n        }).promise;\n        _this2.currentPage = 1;\n        _this2.panOffset = {\n          x: 0,\n          y: 0\n        };\n        yield _this2.renderPage();\n        _this2.loadCalibration();\n      } catch (error) {\n        console.error('Error loading PDF:', error);\n      }\n    })();\n  }\n  renderPage() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this3.pdf || !_this3.canvasRef) return;\n      if (_this3.renderTask) {\n        try {\n          _this3.renderTask.cancel();\n        } catch (err) {}\n      }\n      try {\n        const page = yield _this3.pdf.getPage(_this3.currentPage);\n        const viewport = page.getViewport({\n          scale: _this3.zoom\n        });\n        const canvas = _this3.canvasRef.nativeElement;\n        const context = canvas.getContext('2d');\n        if (!context) return;\n        canvas.width = viewport.width;\n        canvas.height = viewport.height;\n        // keep overlay in sync\n        if (_this3.overlayRef) {\n          const overlay = _this3.overlayRef.nativeElement;\n          overlay.width = viewport.width;\n          overlay.height = viewport.height;\n          _this3.overlayCtx = overlay.getContext('2d');\n          _this3.redrawOverlay();\n        }\n        const renderContext = {\n          canvasContext: context,\n          viewport\n        };\n        _this3.renderTask = page.render(renderContext);\n        yield _this3.renderTask.promise;\n      } catch (error) {\n        console.error('Render error:', error);\n      }\n    })();\n  }\n  onMouseDown(event) {\n    if (this.mode === 'pan') {\n      this.isPanning = true;\n      this.lastMouse = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      return;\n    }\n    if (!this.overlayRef) return;\n    const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    const pdfPoint = {\n      x: x / this.zoom,\n      y: y / this.zoom\n    };\n    if (this.mode === 'terminal') {\n      this.terminals.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n    if (this.mode === 'drop') {\n      this.drops.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n    if (this.mode === 'calibrate') {\n      this.calibrationPoints.push(pdfPoint);\n      if (this.calibrationPoints.length === 2) {\n        this.finishCalibration();\n      }\n      this.redrawOverlay();\n      return;\n    }\n    if (this.mode === 'fiber') {\n      this.isPanning = false;\n      this.hoverPoint = null;\n      // On double-click, finalize the fiber route without adding another point\n      if (event.detail >= 2) {\n        this.commitDrawingPath();\n        return;\n      }\n      // Single click: add point to path\n      if (this.drawingPath.length === 0) {\n        this.drawingPath = [pdfPoint];\n      } else {\n        this.drawingPath = [...this.drawingPath, pdfPoint];\n      }\n      this.redrawOverlay();\n      return;\n    }\n    if (this.mode === 'conduit') {\n      this.isPanning = false;\n      const start = this.findNearestEndpoint(pdfPoint);\n      if (!this.selectedEndpoint) {\n        if (start) {\n          this.selectedEndpoint = start;\n          this.redrawOverlay();\n        }\n        return;\n      }\n      // second click must land on a drop pedestal\n      const end = this.findNearestEndpoint(pdfPoint, 'drop');\n      if (!end) {\n        this.showToast('Select a drop pedestal to complete the conduit');\n        return;\n      }\n      // enforce terminal->drop or drop->drop; block terminal->terminal\n      if (this.selectedEndpoint.type === 'terminal' && end.type === 'terminal') {\n        this.showToast('Cannot connect terminal to terminal');\n        return;\n      }\n      const path = [this.selectedEndpoint.point, end.point];\n      const lengthFt = this.measurePath(path);\n      this.polylines.push({\n        points: path,\n        lengthFt,\n        type: 'conduit'\n      });\n      this.totalConduitFeet = this.polylines.filter(p => p.type === 'conduit').reduce((sum, p) => sum + p.lengthFt, 0);\n      this.selectedEndpoint = null;\n      this.redrawOverlay();\n      return;\n    }\n    // if we reach here, click is ignored (not in a valid mode)\n  }\n  onMouseMove(event) {\n    if (this.mode === 'pan') {\n      if (!this.isPanning) return;\n      const dx = event.clientX - this.lastMouse.x;\n      const dy = event.clientY - this.lastMouse.y;\n      this.panOffset.x += dx;\n      this.panOffset.y += dy;\n      this.lastMouse = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      return;\n    }\n    if (this.mode === 'fiber' && this.drawingPath.length > 0 && this.overlayRef) {\n      const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      this.hoverPoint = {\n        x: x / this.zoom,\n        y: y / this.zoom\n      };\n      this.redrawOverlay();\n    }\n  }\n  onMouseUp() {\n    if (this.mode === 'pan') {\n      this.isPanning = false;\n      return;\n    }\n    if (this.mode === 'fiber' || this.mode === 'conduit') {\n      // Mouse up ends panning only; path commit happens on double-click (fiber) or second click (conduit)\n      return;\n    }\n  }\n  getTransform() {\n    return `translate(${this.panOffset.x}px, ${this.panOffset.y}px)`;\n  }\n  zoomIn() {\n    this.zoom = Math.min(3, this.zoom * 1.2);\n    this.renderPage();\n  }\n  zoomOut() {\n    this.zoom = Math.max(0.5, this.zoom / 1.2);\n    this.renderPage();\n  }\n  setMode(next) {\n    // Require calibration before using drawing tools\n    if (!this.scaleFeetPerPixel && next !== 'calibrate' && next !== 'pan') {\n      this.showToast('Please calibrate the scale first');\n      return;\n    }\n    this.mode = next;\n    this.isPanning = false;\n    // Clear drawing path only when switching to incompatible modes (not when switching to/from pan)\n    if (next !== 'fiber' && next !== 'conduit' && next !== 'pan') {\n      this.drawingPath = [];\n      this.hoverPoint = null;\n    }\n    if (next !== 'conduit' && next !== 'pan') {\n      this.selectedEndpoint = null;\n    }\n    if (next !== 'calibrate') {\n      this.calibrationPoints = [];\n    }\n    this.redrawOverlay();\n  }\n  clearOverlay() {\n    this.polylines = [];\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.selectedEndpoint = null;\n    this.toastMessage = null;\n    this.totalLengthFeet = 0;\n    this.totalConduitFeet = 0;\n    this.calibrationPoints = [];\n    this.terminals = [];\n    this.drops = [];\n    this.redrawOverlay();\n  }\n  clearCalibration() {\n    const key = this.getCalibrationKey();\n    localStorage.removeItem(key);\n    this.scaleFeetPerPixel = null;\n    this.showToast('Calibration cleared');\n    this.redrawOverlay();\n  }\n  getCalibrationKey() {\n    // Use the PDF URL as a unique key for this document\n    return `pdf_calibration_${this.pdfUrl}`;\n  }\n  loadCalibration() {\n    const key = this.getCalibrationKey();\n    const saved = localStorage.getItem(key);\n    if (saved) {\n      try {\n        this.scaleFeetPerPixel = parseFloat(saved);\n        this.showToast('Calibration loaded from saved data');\n        this.redrawOverlay();\n      } catch (e) {\n        console.error('Failed to load calibration:', e);\n      }\n    }\n  }\n  saveCalibration() {\n    if (this.scaleFeetPerPixel !== null) {\n      const key = this.getCalibrationKey();\n      localStorage.setItem(key, this.scaleFeetPerPixel.toString());\n    }\n  }\n  finishCalibration() {\n    if (this.calibrationPoints.length !== 2) return;\n    const [p1, p2] = this.calibrationPoints;\n    const dx = p2.x - p1.x;\n    const dy = p2.y - p1.y;\n    const distPx = Math.sqrt(dx * dx + dy * dy);\n    const input = prompt('Enter real-world distance between points (feet):');\n    const feet = input ? parseFloat(input) : NaN;\n    if (!isNaN(feet) && distPx > 0) {\n      this.scaleFeetPerPixel = feet / distPx;\n      this.saveCalibration();\n      this.showToast('Calibration saved');\n    } else {\n      this.scaleFeetPerPixel = null;\n    }\n    this.calibrationPoints = [];\n  }\n  measurePath(path) {\n    let px = 0;\n    for (let i = 1; i < path.length; i++) {\n      const dx = path[i].x - path[i - 1].x;\n      const dy = path[i].y - path[i - 1].y;\n      px += Math.sqrt(dx * dx + dy * dy);\n    }\n    if (this.scaleFeetPerPixel) {\n      return px * this.scaleFeetPerPixel;\n    }\n    return 0;\n  }\n  commitDrawingPath() {\n    if ((this.mode === 'fiber' || this.mode === 'conduit') && this.drawingPath.length > 1) {\n      const lengthFt = this.measurePath(this.drawingPath);\n      this.polylines.push({\n        points: [...this.drawingPath],\n        lengthFt,\n        type: this.mode\n      });\n      this.totalLengthFeet = this.polylines.filter(p => p.type === 'fiber').reduce((sum, p) => sum + p.lengthFt, 0);\n      this.totalConduitFeet = this.polylines.filter(p => p.type === 'conduit').reduce((sum, p) => sum + p.lengthFt, 0);\n      if (this.mode === 'fiber') {\n        this.showToast(`Fiber route saved: ${lengthFt.toFixed(1)} ft`);\n        this.polylinesChanged.emit(this.polylines);\n      }\n    }\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.redrawOverlay();\n  }\n  saveFiber() {\n    if (this.drawingPath.length < 2) {\n      this.showToast('Need at least 2 points to save fiber');\n      return;\n    }\n    const lengthFt = this.measurePath(this.drawingPath);\n    const polyline = {\n      points: [...this.drawingPath],\n      lengthFt,\n      type: 'fiber'\n    };\n    this.polylines.push(polyline);\n    this.totalLengthFeet = this.polylines.filter(p => p.type === 'fiber').reduce((sum, p) => sum + p.lengthFt, 0);\n    this.polylinesChanged.emit(this.polylines);\n    this.showToast(`Fiber route saved: ${lengthFt.toFixed(1)} ft`);\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.redrawOverlay();\n  }\n  redrawOverlay() {\n    if (!this.overlayCtx || !this.overlayRef) return;\n    const ctx = this.overlayCtx;\n    const overlay = this.overlayRef.nativeElement;\n    ctx.clearRect(0, 0, overlay.width, overlay.height);\n    // calibration points\n    ctx.fillStyle = '#f97316';\n    this.calibrationPoints.forEach(p => {\n      ctx.beginPath();\n      ctx.arc(p.x * this.zoom, p.y * this.zoom, 5, 0, Math.PI * 2);\n      ctx.fill();\n    });\n    // polylines\n    this.polylines.forEach(line => {\n      if (line.points.length < 2) return;\n      ctx.strokeStyle = line.type === 'fiber' ? '#2563eb' : '#9333ea';\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      ctx.moveTo(line.points[0].x * this.zoom, line.points[0].y * this.zoom);\n      for (let i = 1; i < line.points.length; i++) {\n        ctx.lineTo(line.points[i].x * this.zoom, line.points[i].y * this.zoom);\n      }\n      ctx.stroke();\n    });\n    // current drawing\n    if (this.drawingPath.length > 0) {\n      ctx.strokeStyle = '#10b981';\n      ctx.lineWidth = 2;\n      ctx.setLineDash([6, 4]);\n      ctx.beginPath();\n      ctx.moveTo(this.drawingPath[0].x * this.zoom, this.drawingPath[0].y * this.zoom);\n      for (let i = 1; i < this.drawingPath.length; i++) {\n        ctx.lineTo(this.drawingPath[i].x * this.zoom, this.drawingPath[i].y * this.zoom);\n      }\n      // preview to hover point while placing vertices\n      if (this.hoverPoint) {\n        ctx.lineTo(this.hoverPoint.x * this.zoom, this.hoverPoint.y * this.zoom);\n      }\n      ctx.stroke();\n      ctx.setLineDash([]);\n    }\n    // selected terminal highlight\n    if (this.selectedEndpoint) {\n      ctx.strokeStyle = '#22c55e';\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n      ctx.arc(this.selectedEndpoint.point.x * this.zoom, this.selectedEndpoint.point.y * this.zoom, 10, 0, Math.PI * 2);\n      ctx.stroke();\n    }\n    // markers\n    this.terminals.forEach(pt => this.drawTerminal(pt));\n    this.drops.forEach(pt => this.drawMarker(pt, '#a855f7'));\n  }\n  findNearestEndpoint(target, requiredType) {\n    const hitRadius = 12 / this.zoom;\n    const candidates = [];\n    if (!requiredType || requiredType === 'drop') {\n      this.drops.forEach(p => candidates.push({\n        point: p,\n        type: 'drop'\n      }));\n    }\n    if (!requiredType) {\n      this.terminals.forEach(p => candidates.push({\n        point: p,\n        type: 'terminal'\n      }));\n    }\n    let closest = null;\n    let best = Number.MAX_VALUE;\n    candidates.forEach(c => {\n      const dx = c.point.x - target.x;\n      const dy = c.point.y - target.y;\n      const dist = Math.sqrt(dx * dx + dy * dy);\n      if (dist < best && dist <= hitRadius) {\n        best = dist;\n        closest = c;\n      }\n    });\n    return closest;\n  }\n  showToast(message) {\n    this.toastMessage = message;\n    if (this.toastTimer) {\n      clearTimeout(this.toastTimer);\n    }\n    this.toastTimer = setTimeout(() => {\n      this.toastMessage = null;\n    }, 2200);\n  }\n  drawTerminal(pt) {\n    if (!this.overlayCtx) return;\n    const size = 15;\n    const height = size * Math.sqrt(3);\n    const centerX = pt.x * this.zoom;\n    const centerY = pt.y * this.zoom;\n    this.overlayCtx.fillStyle = '#10b981';\n    this.overlayCtx.strokeStyle = '#ffffff';\n    this.overlayCtx.lineWidth = 2;\n    this.overlayCtx.beginPath();\n    this.overlayCtx.moveTo(centerX, centerY - 2 * height / 3);\n    this.overlayCtx.lineTo(centerX - size, centerY + height / 3);\n    this.overlayCtx.lineTo(centerX + size, centerY + height / 3);\n    this.overlayCtx.closePath();\n    this.overlayCtx.fill();\n    this.overlayCtx.stroke();\n  }\n  drawMarker(pt, color) {\n    if (!this.overlayCtx) return;\n    this.overlayCtx.fillStyle = color;\n    this.overlayCtx.strokeStyle = '#ffffff';\n    this.overlayCtx.lineWidth = 2;\n    this.overlayCtx.beginPath();\n    this.overlayCtx.arc(pt.x * this.zoom, pt.y * this.zoom, 12, 0, Math.PI * 2);\n    this.overlayCtx.fill();\n    this.overlayCtx.stroke();\n  }\n  nextPage() {\n    if (this.pdf && this.currentPage < this.pdf.numPages) {\n      this.currentPage++;\n      this.renderPage();\n    }\n  }\n  prevPage() {\n    if (this.pdf && this.currentPage > 1) {\n      this.currentPage--;\n      this.renderPage();\n    }\n  }\n  static {\n    this.ɵfac = function PDFViewerComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || PDFViewerComponent)();\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PDFViewerComponent,\n      selectors: [[\"app-pdf-viewer\"]],\n      viewQuery: function PDFViewerComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5)(_c1, 5)(_c2, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.wrapperRef = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.overlayRef = _t.first);\n        }\n      },\n      inputs: {\n        pdfUrl: \"pdfUrl\"\n      },\n      outputs: {\n        polylinesChanged: \"polylinesChanged\"\n      },\n      features: [i0.ɵɵNgOnChangesFeature],\n      decls: 50,\n      vars: 33,\n      consts: [[\"wrapper\", \"\"], [\"pdfCanvas\", \"\"], [\"overlayCanvas\", \"\"], [1, \"flex\", \"flex-col\", \"h-full\", \"w-full\"], [1, \"bg-white\", \"border-b\", \"shadow\", \"flex\", \"flex-col\", \"gap-2\", \"p-3\"], [1, \"flex\", \"flex-wrap\", \"gap-2\"], [1, \"flex\", \"gap-1\", \"items-center\"], [1, \"px-3\", \"py-1\", \"bg-gray-200\", \"rounded\", \"hover:bg-gray-300\", \"disabled:opacity-50\", 3, \"click\", \"disabled\"], [1, \"px-3\", \"py-1\", \"text-sm\", \"whitespace-nowrap\"], [1, \"px-3\", \"py-1\", \"bg-gray-200\", \"rounded\", \"hover:bg-gray-300\", 3, \"click\"], [1, \"px-3\", \"py-1\", \"text-sm\", \"w-16\", \"text-center\"], [1, \"border-l\"], [1, \"px-3\", \"py-1\", \"rounded\", \"border\", 3, \"click\"], [1, \"relative\"], [1, \"px-3\", \"py-1\", \"rounded\", \"border\", \"hover:bg-gray-100\", 3, \"click\"], [\"class\", \"absolute top-full mt-1 bg-white border rounded shadow z-10 w-40\", 4, \"ngIf\"], [1, \"px-3\", \"py-1\", \"rounded\", \"border\", \"disabled:opacity-50\", \"disabled:cursor-not-allowed\", 3, \"click\", \"disabled\"], [\"class\", \"px-3 py-1 rounded border bg-green-600 text-white hover:bg-green-700\", 3, \"click\", 4, \"ngIf\"], [1, \"px-3\", \"py-1\", \"rounded\", \"border\", \"disabled:opacity-50\", \"disabled:cursor-not-allowed\", \"hover:bg-gray-100\", 3, \"click\", \"disabled\"], [1, \"text-xs\", \"text-gray-700\", \"flex\", \"flex-wrap\", \"gap-x-4\", \"gap-y-1\"], [4, \"ngIf\"], [1, \"relative\", \"bg-gray-100\", \"flex-1\", \"overflow-hidden\", \"flex\", \"items-center\", \"justify-center\", 3, \"mousedown\", \"mousemove\", \"mouseup\", \"mouseleave\"], [1, \"transition-transform\"], [1, \"bg-white\", \"block\"], [1, \"absolute\", \"inset-0\", \"pointer-events-auto\"], [\"class\", \"absolute top-2 left-1/2 -translate-x-1/2 bg-rose-600 text-white px-4 py-2 rounded shadow text-sm pointer-events-none\", 4, \"ngIf\"], [1, \"absolute\", \"top-full\", \"mt-1\", \"bg-white\", \"border\", \"rounded\", \"shadow\", \"z-10\", \"w-40\"], [1, \"block\", \"w-full\", \"text-left\", \"px-4\", \"py-2\", \"hover:bg-gray-100\", \"border-b\", 3, \"click\"], [\"class\", \"block w-full text-left px-4 py-2 hover:bg-gray-100 text-sm\", 3, \"click\", 4, \"ngIf\"], [1, \"block\", \"w-full\", \"text-left\", \"px-4\", \"py-2\", \"hover:bg-gray-100\", \"text-sm\", 3, \"click\"], [1, \"px-3\", \"py-1\", \"rounded\", \"border\", \"bg-green-600\", \"text-white\", \"hover:bg-green-700\", 3, \"click\"], [1, \"block\", \"w-full\", \"text-left\", \"px-4\", \"py-2\", \"hover:bg-gray-100\", 3, \"click\"], [1, \"absolute\", \"top-2\", \"left-1/2\", \"-translate-x-1/2\", \"bg-rose-600\", \"text-white\", \"px-4\", \"py-2\", \"rounded\", \"shadow\", \"text-sm\", \"pointer-events-none\"]],\n      template: function PDFViewerComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 3)(1, \"div\", 4)(2, \"div\", 5)(3, \"div\", 6)(4, \"button\", 7);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_4_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.prevPage());\n          });\n          i0.ɵɵtext(5, \"<\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"span\", 8);\n          i0.ɵɵtext(7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"button\", 7);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_8_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.nextPage());\n          });\n          i0.ɵɵtext(9, \">\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(10, \"div\", 6)(11, \"button\", 9);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_11_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.zoomOut());\n          });\n          i0.ɵɵtext(12, \"\\u2212\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"span\", 10);\n          i0.ɵɵtext(14);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"button\", 9);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_15_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.zoomIn());\n          });\n          i0.ɵɵtext(16, \"+\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(17, \"div\", 11);\n          i0.ɵɵelementStart(18, \"button\", 12);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_18_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"pan\"));\n          });\n          i0.ɵɵtext(19, \"Pan\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"div\", 13)(21, \"button\", 14);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_21_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.showCalibrationMenu = !ctx.showCalibrationMenu);\n          });\n          i0.ɵɵtext(22, \"Calibration \\u25BC\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(23, PDFViewerComponent_div_23_Template, 4, 5, \"div\", 15);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(24, \"button\", 16);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_24_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"fiber\"));\n          });\n          i0.ɵɵtext(25, \"Draw Fiber\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(26, PDFViewerComponent_button_26_Template, 2, 0, \"button\", 17);\n          i0.ɵɵelementStart(27, \"div\", 13)(28, \"button\", 18);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_28_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.showEquipmentMenu = !ctx.showEquipmentMenu);\n          });\n          i0.ɵɵtext(29, \"Equipment \\u25BC\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(30, PDFViewerComponent_div_30_Template, 7, 12, \"div\", 15);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"button\", 12);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_31_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.clearOverlay());\n          });\n          i0.ɵɵtext(32, \"Clear\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(33, \"div\", 19);\n          i0.ɵɵtemplate(34, PDFViewerComponent_div_34_Template, 2, 0, \"div\", 20)(35, PDFViewerComponent_div_35_Template, 2, 2, \"div\", 20);\n          i0.ɵɵelementStart(36, \"div\");\n          i0.ɵɵtext(37);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(38, \"div\");\n          i0.ɵɵtext(39);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(40, \"div\");\n          i0.ɵɵtext(41);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(42, \"div\", 21);\n          i0.ɵɵlistener(\"mousedown\", function PDFViewerComponent_Template_div_mousedown_42_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseDown($event));\n          })(\"mousemove\", function PDFViewerComponent_Template_div_mousemove_42_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseMove($event));\n          })(\"mouseup\", function PDFViewerComponent_Template_div_mouseup_42_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseUp());\n          })(\"mouseleave\", function PDFViewerComponent_Template_div_mouseleave_42_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseUp());\n          });\n          i0.ɵɵelementStart(43, \"div\", 22, 0);\n          i0.ɵɵelement(45, \"canvas\", 23, 1)(47, \"canvas\", 24, 2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(49, PDFViewerComponent_div_49_Template, 2, 1, \"div\", 25);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"disabled\", ctx.currentPage <= 1);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate2(\"Page \", ctx.currentPage, \" / \", (ctx.pdf == null ? null : ctx.pdf.numPages) || 1);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"disabled\", ctx.currentPage >= ((ctx.pdf == null ? null : ctx.pdf.numPages) || 1));\n          i0.ɵɵadvance(6);\n          i0.ɵɵtextInterpolate1(\"\", ctx.Math.round(ctx.zoom * 100), \"%\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"pan\")(\"text-white\", ctx.mode === \"pan\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.showCalibrationMenu);\n          i0.ɵɵadvance();\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"fiber\")(\"text-white\", ctx.mode === \"fiber\");\n          i0.ɵɵproperty(\"disabled\", !ctx.scaleFeetPerPixel);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.drawingPath.length > 0);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", !ctx.scaleFeetPerPixel);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.showEquipmentMenu);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngIf\", !ctx.scaleFeetPerPixel);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.scaleFeetPerPixel);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\"Fiber total: \", ctx.totalLengthFeet.toFixed(1), \" ft\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\"Conduit total: \", ctx.totalConduitFeet.toFixed(1), \" ft\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate2(\"Markers: \", ctx.terminals.length, \" terminals, \", ctx.drops.length, \" drops\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵstyleProp(\"transform\", ctx.getTransform())(\"transition-duration\", ctx.isPanning ? \"0ms\" : \"100ms\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵstyleProp(\"cursor\", ctx.isPanning ? \"grabbing\" : \"grab\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵstyleProp(\"cursor\", ctx.mode === \"fiber\" || ctx.mode === \"conduit\" || ctx.mode === \"calibrate\" ? \"crosshair\" : \"auto\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.toastMessage);\n        }\n      },\n      dependencies: [CommonModule, i1.NgIf],\n      styles: [\"[_nghost-%COMP%] {\\n      display: flex;\\n      height: 100%;\\n      width: 100%;\\n    }\\n  \\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9wZGYtdmlld2VyL3BkZi12aWV3ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7SUFDSTtNQUNFLGFBQWE7TUFDYixZQUFZO01BQ1osV0FBVztJQUNiIiwic291cmNlc0NvbnRlbnQiOlsiXG4gICAgOmhvc3Qge1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cbiAgIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["EventEmitter","CommonModule","pdfjsLib","i0","ɵɵelementStart","ɵɵlistener","PDFViewerComponent_div_23_button_3_Template_button_click_0_listener","ɵɵrestoreView","_r4","ctx_r2","ɵɵnextContext","clearCalibration","ɵɵresetView","showCalibrationMenu","ɵɵtext","ɵɵelementEnd","PDFViewerComponent_div_23_Template_button_click_1_listener","_r2","setMode","ɵɵtemplate","PDFViewerComponent_div_23_button_3_Template","ɵɵadvance","ɵɵclassProp","mode","ɵɵproperty","scaleFeetPerPixel","PDFViewerComponent_button_26_Template_button_click_0_listener","_r5","saveFiber","PDFViewerComponent_div_30_Template_button_click_1_listener","_r6","showEquipmentMenu","PDFViewerComponent_div_30_Template_button_click_3_listener","PDFViewerComponent_div_30_Template_button_click_5_listener","ɵɵtextInterpolate2","toFixed","ɵɵtextInterpolate1","toastMessage","GlobalWorkerOptions","workerSrc","PDFViewerComponent","constructor","pdfUrl","pdf","currentPage","zoom","panOffset","x","y","isPanning","Math","calibrationPoints","drawingPath","hoverPoint","polylines","totalLengthFeet","totalConduitFeet","terminals","drops","selectedEndpoint","toastTimer","renderTask","lastMouse","overlayCtx","polylinesChanged","ngOnInit","_this","_asyncToGenerator","loadPdf","ngOnChanges","changes","firstChange","_this2","response","fetch","ok","console","error","status","statusText","blob","buffer","arrayBuffer","typedArray","Uint8Array","getDocument","data","promise","renderPage","loadCalibration","_this3","canvasRef","cancel","err","page","getPage","viewport","getViewport","scale","canvas","nativeElement","context","getContext","width","height","overlayRef","overlay","redrawOverlay","renderContext","canvasContext","render","onMouseDown","event","clientX","clientY","rect","getBoundingClientRect","left","top","pdfPoint","push","length","finishCalibration","detail","commitDrawingPath","start","findNearestEndpoint","end","showToast","type","path","point","lengthFt","measurePath","points","filter","p","reduce","sum","onMouseMove","dx","dy","onMouseUp","getTransform","zoomIn","min","zoomOut","max","next","clearOverlay","key","getCalibrationKey","localStorage","removeItem","saved","getItem","parseFloat","e","saveCalibration","setItem","toString","p1","p2","distPx","sqrt","input","prompt","feet","NaN","isNaN","px","i","emit","polyline","ctx","clearRect","fillStyle","forEach","beginPath","arc","PI","fill","line","strokeStyle","lineWidth","moveTo","lineTo","stroke","setLineDash","pt","drawTerminal","drawMarker","target","requiredType","hitRadius","candidates","closest","best","Number","MAX_VALUE","c","dist","message","clearTimeout","setTimeout","size","centerX","centerY","closePath","color","nextPage","numPages","prevPage","selectors","viewQuery","PDFViewerComponent_Query","rf","PDFViewerComponent_Template_button_click_4_listener","_r1","PDFViewerComponent_Template_button_click_8_listener","PDFViewerComponent_Template_button_click_11_listener","PDFViewerComponent_Template_button_click_15_listener","ɵɵelement","PDFViewerComponent_Template_button_click_18_listener","PDFViewerComponent_Template_button_click_21_listener","PDFViewerComponent_div_23_Template","PDFViewerComponent_Template_button_click_24_listener","PDFViewerComponent_button_26_Template","PDFViewerComponent_Template_button_click_28_listener","PDFViewerComponent_div_30_Template","PDFViewerComponent_Template_button_click_31_listener","PDFViewerComponent_div_34_Template","PDFViewerComponent_div_35_Template","PDFViewerComponent_Template_div_mousedown_42_listener","$event","PDFViewerComponent_Template_div_mousemove_42_listener","PDFViewerComponent_Template_div_mouseup_42_listener","PDFViewerComponent_Template_div_mouseleave_42_listener","PDFViewerComponent_div_49_Template","round","ɵɵstyleProp","i1","NgIf","styles"],"sources":["/home/dfirth2/fiber_route_calculator/frontend-angular/src/app/components/pdf-viewer/pdf-viewer.component.ts"],"sourcesContent":["import { Component, Input, OnChanges, OnInit, SimpleChanges, ViewChild, ElementRef, Output, EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = '/assets/pdf.worker.min.mjs';\n\n@Component({\n  selector: 'app-pdf-viewer',\n  standalone: true,\n  imports: [CommonModule],\n  template: `\n    <div class=\"flex flex-col h-full w-full\">\n      <!-- Toolbar -->\n      <div class=\"bg-white border-b shadow flex flex-col gap-2 p-3\">\n        <div class=\"flex flex-wrap gap-2\">\n          <div class=\"flex gap-1 items-center\">\n            <button (click)=\"prevPage()\" [disabled]=\"currentPage <= 1\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50\">&lt;</button>\n            <span class=\"px-3 py-1 text-sm whitespace-nowrap\">Page {{ currentPage }} / {{ pdf?.numPages || 1 }}</span>\n            <button (click)=\"nextPage()\" [disabled]=\"currentPage >= (pdf?.numPages || 1)\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50\">&gt;</button>\n          </div>\n          <div class=\"flex gap-1 items-center\">\n            <button (click)=\"zoomOut()\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300\">−</button>\n            <span class=\"px-3 py-1 text-sm w-16 text-center\">{{ Math.round(zoom * 100) }}%</span>\n            <button (click)=\"zoomIn()\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300\">+</button>\n          </div>\n          <div class=\"border-l\"></div>\n          <button (click)=\"setMode('pan')\" [class.bg-blue-600]=\"mode==='pan'\" [class.text-white]=\"mode==='pan'\" class=\"px-3 py-1 rounded border\">Pan</button>\n          \n          <!-- Calibration Menu -->\n          <div class=\"relative\">\n            <button (click)=\"showCalibrationMenu = !showCalibrationMenu\"\n              class=\"px-3 py-1 rounded border hover:bg-gray-100\">Calibration ▼</button>\n            <div *ngIf=\"showCalibrationMenu\" class=\"absolute top-full mt-1 bg-white border rounded shadow z-10 w-40\">\n              <button (click)=\"setMode('calibrate'); showCalibrationMenu = false\"\n                [class.bg-blue-600]=\"mode==='calibrate'\"\n                [class.text-white]=\"mode==='calibrate'\"\n                class=\"block w-full text-left px-4 py-2 hover:bg-gray-100 border-b\">Calibrate</button>\n              <button (click)=\"clearCalibration(); showCalibrationMenu = false\" *ngIf=\"scaleFeetPerPixel\"\n                class=\"block w-full text-left px-4 py-2 hover:bg-gray-100 text-sm\">Reset</button>\n            </div>\n          </div>\n          <button (click)=\"setMode('fiber')\"\n            [disabled]=\"!scaleFeetPerPixel\"\n            [class.bg-blue-600]=\"mode==='fiber'\"\n            [class.text-white]=\"mode==='fiber'\"\n            class=\"px-3 py-1 rounded border disabled:opacity-50 disabled:cursor-not-allowed\">Draw Fiber</button>\n          <button (click)=\"saveFiber()\" \n            *ngIf=\"drawingPath.length > 0\"\n            class=\"px-3 py-1 rounded border bg-green-600 text-white hover:bg-green-700\">Save Fiber</button>\n          \n          <!-- Equipment Menu -->\n          <div class=\"relative\">\n            <button (click)=\"showEquipmentMenu = !showEquipmentMenu\"\n              [disabled]=\"!scaleFeetPerPixel\"\n              class=\"px-3 py-1 rounded border disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100\">Equipment ▼</button>\n            <div *ngIf=\"showEquipmentMenu\" class=\"absolute top-full mt-1 bg-white border rounded shadow z-10 w-40\">\n              <button (click)=\"setMode('terminal'); showEquipmentMenu = false\"\n                [class.bg-blue-600]=\"mode==='terminal'\"\n                [class.text-white]=\"mode==='terminal'\"\n                class=\"block w-full text-left px-4 py-2 hover:bg-gray-100 border-b\">Terminal</button>\n              <button (click)=\"setMode('drop'); showEquipmentMenu = false\"\n                [class.bg-blue-600]=\"mode==='drop'\"\n                [class.text-white]=\"mode==='drop'\"\n                class=\"block w-full text-left px-4 py-2 hover:bg-gray-100 border-b\">Drop Pedestal</button>\n              <button (click)=\"setMode('conduit'); showEquipmentMenu = false\"\n                [class.bg-blue-600]=\"mode==='conduit'\"\n                [class.text-white]=\"mode==='conduit'\"\n                class=\"block w-full text-left px-4 py-2 hover:bg-gray-100\">Conduit</button>\n            </div>\n          </div>\n          <button (click)=\"clearOverlay()\" class=\"px-3 py-1 rounded border\">Clear</button>\n        </div>\n        <div class=\"text-xs text-gray-700 flex flex-wrap gap-x-4 gap-y-1\">\n          <div *ngIf=\"!scaleFeetPerPixel\">Calibrate: click two points on scale, enter real feet.</div>\n          <div *ngIf=\"scaleFeetPerPixel\">Scale: {{ (scaleFeetPerPixel*12).toFixed(4) }} inches/px ({{ (scaleFeetPerPixel).toFixed(4) }} ft/px)</div>\n          <div>Fiber total: {{ totalLengthFeet.toFixed(1) }} ft</div>\n          <div>Conduit total: {{ totalConduitFeet.toFixed(1) }} ft</div>\n          <div>Markers: {{ terminals.length }} terminals, {{ drops.length }} drops</div>\n        </div>\n      </div>\n\n      <!-- PDF Viewer -->\n      <div\n        class=\"relative bg-gray-100 flex-1 overflow-hidden flex items-center justify-center\"\n        (mousedown)=\"onMouseDown($event)\"\n        (mousemove)=\"onMouseMove($event)\"\n        (mouseup)=\"onMouseUp()\"\n        (mouseleave)=\"onMouseUp()\"\n      >\n        <div\n          #wrapper\n          class=\"transition-transform\"\n          [style.transform]=\"getTransform()\"\n          [style.transitionDuration]=\"isPanning ? '0ms' : '100ms'\"\n        >\n          <canvas #pdfCanvas class=\"bg-white block\" [style.cursor]=\"isPanning ? 'grabbing' : 'grab'\"></canvas>\n          <canvas\n            #overlayCanvas\n            class=\"absolute inset-0 pointer-events-auto\"\n            [style.cursor]=\"(mode === 'fiber' || mode === 'conduit' || mode === 'calibrate') ? 'crosshair' : 'auto'\"\n          ></canvas>\n        </div>\n\n        <div *ngIf=\"toastMessage\" class=\"absolute top-2 left-1/2 -translate-x-1/2 bg-rose-600 text-white px-4 py-2 rounded shadow text-sm pointer-events-none\">\n          {{ toastMessage }}\n        </div>\n      </div>\n    </div>\n  `,\n  styles: [`\n    :host {\n      display: flex;\n      height: 100%;\n      width: 100%;\n    }\n  `]\n})\nexport class PDFViewerComponent implements OnInit, OnChanges {\n  @ViewChild('pdfCanvas') canvasRef!: ElementRef<HTMLCanvasElement>;\n  @ViewChild('wrapper') wrapperRef!: ElementRef<HTMLDivElement>;\n  @ViewChild('overlayCanvas') overlayRef!: ElementRef<HTMLCanvasElement>;\n  @Input() pdfUrl: string = '';\n\n  pdf: any = null;\n  currentPage = 1;\n  zoom = 1;\n  panOffset = { x: 0, y: 0 };\n  isPanning = false;\n  Math = Math;\n\n  mode: 'pan' | 'calibrate' | 'fiber' | 'conduit' | 'terminal' | 'drop' = 'pan';\n  calibrationPoints: { x: number; y: number }[] = [];\n  scaleFeetPerPixel: number | null = null;\n  drawingPath: { x: number; y: number }[] = [];\n  hoverPoint: { x: number; y: number } | null = null;\n  polylines: { points: { x: number; y: number }[]; lengthFt: number; type: 'fiber' | 'conduit' }[] = [];\n  totalLengthFeet = 0;\n  totalConduitFeet = 0;\n  terminals: { x: number; y: number }[] = [];\n  drops: { x: number; y: number }[] = [];\n  selectedEndpoint: { point: { x: number; y: number }; type: 'terminal' | 'drop' } | null = null;\n  toastMessage: string | null = null;\n  showEquipmentMenu = false;\n  showCalibrationMenu = false;\n  private toastTimer: any = null;\n\n  private renderTask: any = null;\n  private lastMouse = { x: 0, y: 0 };\n  private overlayCtx: CanvasRenderingContext2D | null = null;\n\n  @Output() polylinesChanged = new EventEmitter<any[]>();\n\n  async ngOnInit() {\n    if (this.pdfUrl) {\n      await this.loadPdf();\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes['pdfUrl'] && !changes['pdfUrl'].firstChange && this.pdfUrl) {\n      this.loadPdf();\n    }\n  }\n\n  async loadPdf() {\n    if (!this.pdfUrl) return;\n    try {\n      const response = await fetch(this.pdfUrl);\n      if (!response.ok) {\n        console.error('Failed to fetch PDF:', response.status, response.statusText);\n        return;\n      }\n      const blob = await response.blob();\n      const buffer = await blob.arrayBuffer();\n      const typedArray = new Uint8Array(buffer);\n      this.pdf = await pdfjsLib.getDocument({ data: typedArray }).promise;\n      this.currentPage = 1;\n      this.panOffset = { x: 0, y: 0 };\n      await this.renderPage();\n      this.loadCalibration();\n    } catch (error) {\n      console.error('Error loading PDF:', error);\n    }\n  }\n\n  async renderPage() {\n    if (!this.pdf || !this.canvasRef) return;\n\n    if (this.renderTask) {\n      try {\n        this.renderTask.cancel();\n      } catch (err) {}\n    }\n\n    try {\n      const page = await this.pdf.getPage(this.currentPage);\n      const viewport = page.getViewport({ scale: this.zoom });\n\n      const canvas = this.canvasRef.nativeElement;\n      const context = canvas.getContext('2d');\n      if (!context) return;\n\n      canvas.width = viewport.width;\n      canvas.height = viewport.height;\n\n      // keep overlay in sync\n      if (this.overlayRef) {\n        const overlay = this.overlayRef.nativeElement;\n        overlay.width = viewport.width;\n        overlay.height = viewport.height;\n        this.overlayCtx = overlay.getContext('2d');\n        this.redrawOverlay();\n      }\n\n      const renderContext = { canvasContext: context, viewport };\n      this.renderTask = page.render(renderContext);\n      await this.renderTask.promise;\n    } catch (error) {\n      console.error('Render error:', error);\n    }\n  }\n\n  onMouseDown(event: MouseEvent) {\n    if (this.mode === 'pan') {\n      this.isPanning = true;\n      this.lastMouse = { x: event.clientX, y: event.clientY };\n      return;\n    }\n\n    if (!this.overlayRef) return;\n    const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    const pdfPoint = { x: x / this.zoom, y: y / this.zoom };\n\n    if (this.mode === 'terminal') {\n      this.terminals.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n\n    if (this.mode === 'drop') {\n      this.drops.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n\n    if (this.mode === 'calibrate') {\n      this.calibrationPoints.push(pdfPoint);\n      if (this.calibrationPoints.length === 2) {\n        this.finishCalibration();\n      }\n      this.redrawOverlay();\n      return;\n    }\n\n    if (this.mode === 'fiber') {\n      this.isPanning = false;\n      this.hoverPoint = null;\n      \n      // On double-click, finalize the fiber route without adding another point\n      if (event.detail >= 2) {\n        this.commitDrawingPath();\n        return;\n      }\n      \n      // Single click: add point to path\n      if (this.drawingPath.length === 0) {\n        this.drawingPath = [pdfPoint];\n      } else {\n        this.drawingPath = [...this.drawingPath, pdfPoint];\n      }\n      this.redrawOverlay();\n      return;\n    }\n\n    if (this.mode === 'conduit') {\n      this.isPanning = false;\n      const start = this.findNearestEndpoint(pdfPoint);\n      if (!this.selectedEndpoint) {\n        if (start) {\n          this.selectedEndpoint = start;\n          this.redrawOverlay();\n        }\n        return;\n      }\n\n      // second click must land on a drop pedestal\n      const end = this.findNearestEndpoint(pdfPoint, 'drop');\n      if (!end) {\n        this.showToast('Select a drop pedestal to complete the conduit');\n        return;\n      }\n\n      // enforce terminal->drop or drop->drop; block terminal->terminal\n      if (this.selectedEndpoint.type === 'terminal' && end.type === 'terminal') {\n        this.showToast('Cannot connect terminal to terminal');\n        return;\n      }\n\n      const path = [this.selectedEndpoint.point, end.point];\n      const lengthFt = this.measurePath(path);\n      this.polylines.push({ points: path, lengthFt, type: 'conduit' });\n      this.totalConduitFeet = this.polylines.filter(p => p.type === 'conduit').reduce((sum, p) => sum + p.lengthFt, 0);\n      this.selectedEndpoint = null;\n      this.redrawOverlay();\n      return;\n    }\n\n    // if we reach here, click is ignored (not in a valid mode)\n  }\n\n  onMouseMove(event: MouseEvent) {\n    if (this.mode === 'pan') {\n      if (!this.isPanning) return;\n      const dx = event.clientX - this.lastMouse.x;\n      const dy = event.clientY - this.lastMouse.y;\n      this.panOffset.x += dx;\n      this.panOffset.y += dy;\n      this.lastMouse = { x: event.clientX, y: event.clientY };\n      return;\n    }\n\n    if (this.mode === 'fiber' && this.drawingPath.length > 0 && this.overlayRef) {\n      const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      this.hoverPoint = { x: x / this.zoom, y: y / this.zoom };\n      this.redrawOverlay();\n    }\n  }\n\n  onMouseUp() {\n    if (this.mode === 'pan') {\n      this.isPanning = false;\n      return;\n    }\n\n    if (this.mode === 'fiber' || this.mode === 'conduit') {\n      // Mouse up ends panning only; path commit happens on double-click (fiber) or second click (conduit)\n      return;\n    }\n  }\n\n  getTransform(): string {\n    return `translate(${this.panOffset.x}px, ${this.panOffset.y}px)`;\n  }\n\n  zoomIn() {\n    this.zoom = Math.min(3, this.zoom * 1.2);\n    this.renderPage();\n  }\n\n  zoomOut() {\n    this.zoom = Math.max(0.5, this.zoom / 1.2);\n    this.renderPage();\n  }\n\n  setMode(next: 'pan' | 'calibrate' | 'fiber' | 'conduit' | 'terminal' | 'drop') {\n    // Require calibration before using drawing tools\n    if (!this.scaleFeetPerPixel && next !== 'calibrate' && next !== 'pan') {\n      this.showToast('Please calibrate the scale first');\n      return;\n    }\n    this.mode = next;\n    this.isPanning = false;\n    // Clear drawing path only when switching to incompatible modes (not when switching to/from pan)\n    if (next !== 'fiber' && next !== 'conduit' && next !== 'pan') {\n      this.drawingPath = [];\n      this.hoverPoint = null;\n    }\n    if (next !== 'conduit' && next !== 'pan') {\n      this.selectedEndpoint = null;\n    }\n    if (next !== 'calibrate') {\n      this.calibrationPoints = [];\n    }\n    this.redrawOverlay();\n  }\n\n  clearOverlay() {\n    this.polylines = [];\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.selectedEndpoint = null;\n    this.toastMessage = null;\n    this.totalLengthFeet = 0;\n    this.totalConduitFeet = 0;\n    this.calibrationPoints = [];\n    this.terminals = [];\n    this.drops = [];\n    this.redrawOverlay();\n  }\n\n  clearCalibration() {\n    const key = this.getCalibrationKey();\n    localStorage.removeItem(key);\n    this.scaleFeetPerPixel = null;\n    this.showToast('Calibration cleared');\n    this.redrawOverlay();\n  }\n\n  private getCalibrationKey(): string {\n    // Use the PDF URL as a unique key for this document\n    return `pdf_calibration_${this.pdfUrl}`;\n  }\n\n  private loadCalibration() {\n    const key = this.getCalibrationKey();\n    const saved = localStorage.getItem(key);\n    if (saved) {\n      try {\n        this.scaleFeetPerPixel = parseFloat(saved);\n        this.showToast('Calibration loaded from saved data');\n        this.redrawOverlay();\n      } catch (e) {\n        console.error('Failed to load calibration:', e);\n      }\n    }\n  }\n\n  private saveCalibration() {\n    if (this.scaleFeetPerPixel !== null) {\n      const key = this.getCalibrationKey();\n      localStorage.setItem(key, this.scaleFeetPerPixel.toString());\n    }\n  }\n\n  private finishCalibration() {\n    if (this.calibrationPoints.length !== 2) return;\n    const [p1, p2] = this.calibrationPoints;\n    const dx = p2.x - p1.x;\n    const dy = p2.y - p1.y;\n    const distPx = Math.sqrt(dx * dx + dy * dy);\n    const input = prompt('Enter real-world distance between points (feet):');\n    const feet = input ? parseFloat(input) : NaN;\n    if (!isNaN(feet) && distPx > 0) {\n      this.scaleFeetPerPixel = feet / distPx;\n      this.saveCalibration();\n      this.showToast('Calibration saved');\n    } else {\n      this.scaleFeetPerPixel = null;\n    }\n    this.calibrationPoints = [];\n  }\n\n  private measurePath(path: { x: number; y: number }[]): number {\n    let px = 0;\n    for (let i = 1; i < path.length; i++) {\n      const dx = path[i].x - path[i - 1].x;\n      const dy = path[i].y - path[i - 1].y;\n      px += Math.sqrt(dx * dx + dy * dy);\n    }\n    if (this.scaleFeetPerPixel) {\n      return px * this.scaleFeetPerPixel;\n    }\n    return 0;\n  }\n\n  private commitDrawingPath() {\n    if ((this.mode === 'fiber' || this.mode === 'conduit') && this.drawingPath.length > 1) {\n      const lengthFt = this.measurePath(this.drawingPath);\n      this.polylines.push({ points: [...this.drawingPath], lengthFt, type: this.mode });\n      this.totalLengthFeet = this.polylines.filter(p => p.type === 'fiber').reduce((sum, p) => sum + p.lengthFt, 0);\n      this.totalConduitFeet = this.polylines.filter(p => p.type === 'conduit').reduce((sum, p) => sum + p.lengthFt, 0);\n      \n      if (this.mode === 'fiber') {\n        this.showToast(`Fiber route saved: ${lengthFt.toFixed(1)} ft`);\n        this.polylinesChanged.emit(this.polylines);\n      }\n    }\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.redrawOverlay();\n  }\n\n  saveFiber() {\n    if (this.drawingPath.length < 2) {\n      this.showToast('Need at least 2 points to save fiber');\n      return;\n    }\n    const lengthFt = this.measurePath(this.drawingPath);\n    const polyline = { points: [...this.drawingPath], lengthFt, type: 'fiber' as const };\n    this.polylines.push(polyline);\n    this.totalLengthFeet = this.polylines.filter(p => p.type === 'fiber').reduce((sum, p) => sum + p.lengthFt, 0);\n    this.polylinesChanged.emit(this.polylines);\n    this.showToast(`Fiber route saved: ${lengthFt.toFixed(1)} ft`);\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.redrawOverlay();\n  }\n\n  private redrawOverlay() {\n    if (!this.overlayCtx || !this.overlayRef) return;\n    const ctx = this.overlayCtx;\n    const overlay = this.overlayRef.nativeElement;\n    ctx.clearRect(0, 0, overlay.width, overlay.height);\n\n    // calibration points\n    ctx.fillStyle = '#f97316';\n    this.calibrationPoints.forEach(p => {\n      ctx.beginPath();\n      ctx.arc(p.x * this.zoom, p.y * this.zoom, 5, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // polylines\n    this.polylines.forEach(line => {\n      if (line.points.length < 2) return;\n      ctx.strokeStyle = line.type === 'fiber' ? '#2563eb' : '#9333ea';\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      ctx.moveTo(line.points[0].x * this.zoom, line.points[0].y * this.zoom);\n      for (let i = 1; i < line.points.length; i++) {\n        ctx.lineTo(line.points[i].x * this.zoom, line.points[i].y * this.zoom);\n      }\n      ctx.stroke();\n    });\n\n    // current drawing\n    if (this.drawingPath.length > 0) {\n      ctx.strokeStyle = '#10b981';\n      ctx.lineWidth = 2;\n      ctx.setLineDash([6, 4]);\n      ctx.beginPath();\n      ctx.moveTo(this.drawingPath[0].x * this.zoom, this.drawingPath[0].y * this.zoom);\n      for (let i = 1; i < this.drawingPath.length; i++) {\n        ctx.lineTo(this.drawingPath[i].x * this.zoom, this.drawingPath[i].y * this.zoom);\n      }\n\n      // preview to hover point while placing vertices\n      if (this.hoverPoint) {\n        ctx.lineTo(this.hoverPoint.x * this.zoom, this.hoverPoint.y * this.zoom);\n      }\n      ctx.stroke();\n      ctx.setLineDash([]);\n    }\n\n    // selected terminal highlight\n    if (this.selectedEndpoint) {\n      ctx.strokeStyle = '#22c55e';\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n      ctx.arc(this.selectedEndpoint.point.x * this.zoom, this.selectedEndpoint.point.y * this.zoom, 10, 0, Math.PI * 2);\n      ctx.stroke();\n    }\n\n    // markers\n    this.terminals.forEach(pt => this.drawTerminal(pt));\n    this.drops.forEach(pt => this.drawMarker(pt, '#a855f7'));\n  }\n\n  private findNearestEndpoint(target: { x: number; y: number }, requiredType?: 'drop'): { point: { x: number; y: number }; type: 'terminal' | 'drop' } | null {\n    const hitRadius = 12 / this.zoom;\n    const candidates: { point: { x: number; y: number }; type: 'terminal' | 'drop' }[] = [];\n    if (!requiredType || requiredType === 'drop') {\n      this.drops.forEach(p => candidates.push({ point: p, type: 'drop' }));\n    }\n    if (!requiredType) {\n      this.terminals.forEach(p => candidates.push({ point: p, type: 'terminal' }));\n    }\n    let closest: { point: { x: number; y: number }; type: 'terminal' | 'drop' } | null = null;\n    let best = Number.MAX_VALUE;\n    candidates.forEach(c => {\n      const dx = c.point.x - target.x;\n      const dy = c.point.y - target.y;\n      const dist = Math.sqrt(dx * dx + dy * dy);\n      if (dist < best && dist <= hitRadius) {\n        best = dist;\n        closest = c;\n      }\n    });\n    return closest;\n  }\n\n  private showToast(message: string) {\n    this.toastMessage = message;\n    if (this.toastTimer) {\n      clearTimeout(this.toastTimer);\n    }\n    this.toastTimer = setTimeout(() => {\n      this.toastMessage = null;\n    }, 2200);\n  }\n\n  private drawTerminal(pt: { x: number; y: number }) {\n    if (!this.overlayCtx) return;\n    const size = 15;\n    const height = size * Math.sqrt(3);\n    const centerX = pt.x * this.zoom;\n    const centerY = pt.y * this.zoom;\n    this.overlayCtx.fillStyle = '#10b981';\n    this.overlayCtx.strokeStyle = '#ffffff';\n    this.overlayCtx.lineWidth = 2;\n    this.overlayCtx.beginPath();\n    this.overlayCtx.moveTo(centerX, centerY - (2 * height / 3));\n    this.overlayCtx.lineTo(centerX - size, centerY + (height / 3));\n    this.overlayCtx.lineTo(centerX + size, centerY + (height / 3));\n    this.overlayCtx.closePath();\n    this.overlayCtx.fill();\n    this.overlayCtx.stroke();\n  }\n\n  private drawMarker(pt: { x: number; y: number }, color: string) {\n    if (!this.overlayCtx) return;\n    this.overlayCtx.fillStyle = color;\n    this.overlayCtx.strokeStyle = '#ffffff';\n    this.overlayCtx.lineWidth = 2;\n    this.overlayCtx.beginPath();\n    this.overlayCtx.arc(pt.x * this.zoom, pt.y * this.zoom, 12, 0, Math.PI * 2);\n    this.overlayCtx.fill();\n    this.overlayCtx.stroke();\n  }\n\n  nextPage() {\n    if (this.pdf && this.currentPage < this.pdf.numPages) {\n      this.currentPage++;\n      this.renderPage();\n    }\n  }\n\n  prevPage() {\n    if (this.pdf && this.currentPage > 1) {\n      this.currentPage--;\n      this.renderPage();\n    }\n  }\n}\n"],"mappings":";AAAA,SAA4FA,YAAY,QAAQ,eAAe;AAC/H,SAASC,YAAY,QAAQ,iBAAiB;AAC9C,OAAO,KAAKC,QAAQ,MAAM,YAAY;;;;;;;;;IAmCxBC,EAAA,CAAAC,cAAA,iBACqE;IAD7DD,EAAA,CAAAE,UAAA,mBAAAC,oEAAA;MAAAH,EAAA,CAAAI,aAAA,CAAAC,GAAA;MAAA,MAAAC,MAAA,GAAAN,EAAA,CAAAO,aAAA;MAASD,MAAA,CAAAE,gBAAA,EAAkB;MAAA,OAAAR,EAAA,CAAAS,WAAA,CAAAH,MAAA,CAAAI,mBAAA,GAAwB,KAAK;IAAA,EAAC;IACIV,EAAA,CAAAW,MAAA,YAAK;IAAAX,EAAA,CAAAY,YAAA,EAAS;;;;;;IALnFZ,EADF,CAAAC,cAAA,cAAyG,iBAIjC;IAH9DD,EAAA,CAAAE,UAAA,mBAAAW,2DAAA;MAAAb,EAAA,CAAAI,aAAA,CAAAU,GAAA;MAAA,MAAAR,MAAA,GAAAN,EAAA,CAAAO,aAAA;MAASD,MAAA,CAAAS,OAAA,CAAQ,WAAW,CAAC;MAAA,OAAAf,EAAA,CAAAS,WAAA,CAAAH,MAAA,CAAAI,mBAAA,GAAwB,KAAK;IAAA,EAAC;IAGGV,EAAA,CAAAW,MAAA,gBAAS;IAAAX,EAAA,CAAAY,YAAA,EAAS;IACxFZ,EAAA,CAAAgB,UAAA,IAAAC,2CAAA,qBACqE;IACvEjB,EAAA,CAAAY,YAAA,EAAM;;;;IALFZ,EAAA,CAAAkB,SAAA,EAAwC;IACxClB,EADA,CAAAmB,WAAA,gBAAAb,MAAA,CAAAc,IAAA,iBAAwC,eAAAd,MAAA,CAAAc,IAAA,iBACD;IAE0BpB,EAAA,CAAAkB,SAAA,GAAuB;IAAvBlB,EAAA,CAAAqB,UAAA,SAAAf,MAAA,CAAAgB,iBAAA,CAAuB;;;;;;IAS9FtB,EAAA,CAAAC,cAAA,iBAE8E;IAFtED,EAAA,CAAAE,UAAA,mBAAAqB,8DAAA;MAAAvB,EAAA,CAAAI,aAAA,CAAAoB,GAAA;MAAA,MAAAlB,MAAA,GAAAN,EAAA,CAAAO,aAAA;MAAA,OAAAP,EAAA,CAAAS,WAAA,CAASH,MAAA,CAAAmB,SAAA,EAAW;IAAA,EAAC;IAEiDzB,EAAA,CAAAW,MAAA,iBAAU;IAAAX,EAAA,CAAAY,YAAA,EAAS;;;;;;IAQ7FZ,EADF,CAAAC,cAAA,cAAuG,iBAI/B;IAH9DD,EAAA,CAAAE,UAAA,mBAAAwB,2DAAA;MAAA1B,EAAA,CAAAI,aAAA,CAAAuB,GAAA;MAAA,MAAArB,MAAA,GAAAN,EAAA,CAAAO,aAAA;MAASD,MAAA,CAAAS,OAAA,CAAQ,UAAU,CAAC;MAAA,OAAAf,EAAA,CAAAS,WAAA,CAAAH,MAAA,CAAAsB,iBAAA,GAAsB,KAAK;IAAA,EAAC;IAGM5B,EAAA,CAAAW,MAAA,eAAQ;IAAAX,EAAA,CAAAY,YAAA,EAAS;IACvFZ,EAAA,CAAAC,cAAA,iBAGsE;IAH9DD,EAAA,CAAAE,UAAA,mBAAA2B,2DAAA;MAAA7B,EAAA,CAAAI,aAAA,CAAAuB,GAAA;MAAA,MAAArB,MAAA,GAAAN,EAAA,CAAAO,aAAA;MAASD,MAAA,CAAAS,OAAA,CAAQ,MAAM,CAAC;MAAA,OAAAf,EAAA,CAAAS,WAAA,CAAAH,MAAA,CAAAsB,iBAAA,GAAsB,KAAK;IAAA,EAAC;IAGU5B,EAAA,CAAAW,MAAA,oBAAa;IAAAX,EAAA,CAAAY,YAAA,EAAS;IAC5FZ,EAAA,CAAAC,cAAA,iBAG6D;IAHrDD,EAAA,CAAAE,UAAA,mBAAA4B,2DAAA;MAAA9B,EAAA,CAAAI,aAAA,CAAAuB,GAAA;MAAA,MAAArB,MAAA,GAAAN,EAAA,CAAAO,aAAA;MAASD,MAAA,CAAAS,OAAA,CAAQ,SAAS,CAAC;MAAA,OAAAf,EAAA,CAAAS,WAAA,CAAAH,MAAA,CAAAsB,iBAAA,GAAsB,KAAK;IAAA,EAAC;IAGF5B,EAAA,CAAAW,MAAA,cAAO;IACtEX,EADsE,CAAAY,YAAA,EAAS,EACzE;;;;IAXFZ,EAAA,CAAAkB,SAAA,EAAuC;IACvClB,EADA,CAAAmB,WAAA,gBAAAb,MAAA,CAAAc,IAAA,gBAAuC,eAAAd,MAAA,CAAAc,IAAA,gBACD;IAGtCpB,EAAA,CAAAkB,SAAA,GAAmC;IACnClB,EADA,CAAAmB,WAAA,gBAAAb,MAAA,CAAAc,IAAA,YAAmC,eAAAd,MAAA,CAAAc,IAAA,YACD;IAGlCpB,EAAA,CAAAkB,SAAA,GAAsC;IACtClB,EADA,CAAAmB,WAAA,gBAAAb,MAAA,CAAAc,IAAA,eAAsC,eAAAd,MAAA,CAAAc,IAAA,eACD;;;;;IAO3CpB,EAAA,CAAAC,cAAA,UAAgC;IAAAD,EAAA,CAAAW,MAAA,6DAAsD;IAAAX,EAAA,CAAAY,YAAA,EAAM;;;;;IAC5FZ,EAAA,CAAAC,cAAA,UAA+B;IAAAD,EAAA,CAAAW,MAAA,GAAqG;IAAAX,EAAA,CAAAY,YAAA,EAAM;;;;IAA3GZ,EAAA,CAAAkB,SAAA,EAAqG;IAArGlB,EAAA,CAAA+B,kBAAA,aAAAzB,MAAA,CAAAgB,iBAAA,OAAAU,OAAA,qBAAA1B,MAAA,CAAAgB,iBAAA,CAAAU,OAAA,eAAqG;;;;;IA6BtIhC,EAAA,CAAAC,cAAA,cAAuJ;IACrJD,EAAA,CAAAW,MAAA,GACF;IAAAX,EAAA,CAAAY,YAAA,EAAM;;;;IADJZ,EAAA,CAAAkB,SAAA,EACF;IADElB,EAAA,CAAAiC,kBAAA,MAAA3B,MAAA,CAAA4B,YAAA,MACF;;;AArGRnC,QAAQ,CAACoC,mBAAmB,CAACC,SAAS,GAAG,4BAA4B;AAiHrE,OAAM,MAAOC,kBAAkB;EA/G/BC,YAAA;IAmHW,KAAAC,MAAM,GAAW,EAAE;IAE5B,KAAAC,GAAG,GAAQ,IAAI;IACf,KAAAC,WAAW,GAAG,CAAC;IACf,KAAAC,IAAI,GAAG,CAAC;IACR,KAAAC,SAAS,GAAG;MAAEC,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAC,CAAE;IAC1B,KAAAC,SAAS,GAAG,KAAK;IACjB,KAAAC,IAAI,GAAGA,IAAI;IAEX,KAAA3B,IAAI,GAAoE,KAAK;IAC7E,KAAA4B,iBAAiB,GAA+B,EAAE;IAClD,KAAA1B,iBAAiB,GAAkB,IAAI;IACvC,KAAA2B,WAAW,GAA+B,EAAE;IAC5C,KAAAC,UAAU,GAAoC,IAAI;IAClD,KAAAC,SAAS,GAA0F,EAAE;IACrG,KAAAC,eAAe,GAAG,CAAC;IACnB,KAAAC,gBAAgB,GAAG,CAAC;IACpB,KAAAC,SAAS,GAA+B,EAAE;IAC1C,KAAAC,KAAK,GAA+B,EAAE;IACtC,KAAAC,gBAAgB,GAA0E,IAAI;IAC9F,KAAAtB,YAAY,GAAkB,IAAI;IAClC,KAAAN,iBAAiB,GAAG,KAAK;IACzB,KAAAlB,mBAAmB,GAAG,KAAK;IACnB,KAAA+C,UAAU,GAAQ,IAAI;IAEtB,KAAAC,UAAU,GAAQ,IAAI;IACtB,KAAAC,SAAS,GAAG;MAAEf,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAC,CAAE;IAC1B,KAAAe,UAAU,GAAoC,IAAI;IAEhD,KAAAC,gBAAgB,GAAG,IAAIhE,YAAY,EAAS;;EAEhDiE,QAAQA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACZ,IAAID,KAAI,CAACxB,MAAM,EAAE;QACf,MAAMwB,KAAI,CAACE,OAAO,EAAE;MACtB;IAAC;EACH;EAEAC,WAAWA,CAACC,OAAsB;IAChC,IAAIA,OAAO,CAAC,QAAQ,CAAC,IAAI,CAACA,OAAO,CAAC,QAAQ,CAAC,CAACC,WAAW,IAAI,IAAI,CAAC7B,MAAM,EAAE;MACtE,IAAI,CAAC0B,OAAO,EAAE;IAChB;EACF;EAEMA,OAAOA,CAAA;IAAA,IAAAI,MAAA;IAAA,OAAAL,iBAAA;MACX,IAAI,CAACK,MAAI,CAAC9B,MAAM,EAAE;MAClB,IAAI;QACF,MAAM+B,QAAQ,SAASC,KAAK,CAACF,MAAI,CAAC9B,MAAM,CAAC;QACzC,IAAI,CAAC+B,QAAQ,CAACE,EAAE,EAAE;UAChBC,OAAO,CAACC,KAAK,CAAC,sBAAsB,EAAEJ,QAAQ,CAACK,MAAM,EAAEL,QAAQ,CAACM,UAAU,CAAC;UAC3E;QACF;QACA,MAAMC,IAAI,SAASP,QAAQ,CAACO,IAAI,EAAE;QAClC,MAAMC,MAAM,SAASD,IAAI,CAACE,WAAW,EAAE;QACvC,MAAMC,UAAU,GAAG,IAAIC,UAAU,CAACH,MAAM,CAAC;QACzCT,MAAI,CAAC7B,GAAG,SAASzC,QAAQ,CAACmF,WAAW,CAAC;UAAEC,IAAI,EAAEH;QAAU,CAAE,CAAC,CAACI,OAAO;QACnEf,MAAI,CAAC5B,WAAW,GAAG,CAAC;QACpB4B,MAAI,CAAC1B,SAAS,GAAG;UAAEC,CAAC,EAAE,CAAC;UAAEC,CAAC,EAAE;QAAC,CAAE;QAC/B,MAAMwB,MAAI,CAACgB,UAAU,EAAE;QACvBhB,MAAI,CAACiB,eAAe,EAAE;MACxB,CAAC,CAAC,OAAOZ,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;MAC5C;IAAC;EACH;EAEMW,UAAUA,CAAA;IAAA,IAAAE,MAAA;IAAA,OAAAvB,iBAAA;MACd,IAAI,CAACuB,MAAI,CAAC/C,GAAG,IAAI,CAAC+C,MAAI,CAACC,SAAS,EAAE;MAElC,IAAID,MAAI,CAAC7B,UAAU,EAAE;QACnB,IAAI;UACF6B,MAAI,CAAC7B,UAAU,CAAC+B,MAAM,EAAE;QAC1B,CAAC,CAAC,OAAOC,GAAG,EAAE,CAAC;MACjB;MAEA,IAAI;QACF,MAAMC,IAAI,SAASJ,MAAI,CAAC/C,GAAG,CAACoD,OAAO,CAACL,MAAI,CAAC9C,WAAW,CAAC;QACrD,MAAMoD,QAAQ,GAAGF,IAAI,CAACG,WAAW,CAAC;UAAEC,KAAK,EAAER,MAAI,CAAC7C;QAAI,CAAE,CAAC;QAEvD,MAAMsD,MAAM,GAAGT,MAAI,CAACC,SAAS,CAACS,aAAa;QAC3C,MAAMC,OAAO,GAAGF,MAAM,CAACG,UAAU,CAAC,IAAI,CAAC;QACvC,IAAI,CAACD,OAAO,EAAE;QAEdF,MAAM,CAACI,KAAK,GAAGP,QAAQ,CAACO,KAAK;QAC7BJ,MAAM,CAACK,MAAM,GAAGR,QAAQ,CAACQ,MAAM;QAE/B;QACA,IAAId,MAAI,CAACe,UAAU,EAAE;UACnB,MAAMC,OAAO,GAAGhB,MAAI,CAACe,UAAU,CAACL,aAAa;UAC7CM,OAAO,CAACH,KAAK,GAAGP,QAAQ,CAACO,KAAK;UAC9BG,OAAO,CAACF,MAAM,GAAGR,QAAQ,CAACQ,MAAM;UAChCd,MAAI,CAAC3B,UAAU,GAAG2C,OAAO,CAACJ,UAAU,CAAC,IAAI,CAAC;UAC1CZ,MAAI,CAACiB,aAAa,EAAE;QACtB;QAEA,MAAMC,aAAa,GAAG;UAAEC,aAAa,EAAER,OAAO;UAAEL;QAAQ,CAAE;QAC1DN,MAAI,CAAC7B,UAAU,GAAGiC,IAAI,CAACgB,MAAM,CAACF,aAAa,CAAC;QAC5C,MAAMlB,MAAI,CAAC7B,UAAU,CAAC0B,OAAO;MAC/B,CAAC,CAAC,OAAOV,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,eAAe,EAAEA,KAAK,CAAC;MACvC;IAAC;EACH;EAEAkC,WAAWA,CAACC,KAAiB;IAC3B,IAAI,IAAI,CAACzF,IAAI,KAAK,KAAK,EAAE;MACvB,IAAI,CAAC0B,SAAS,GAAG,IAAI;MACrB,IAAI,CAACa,SAAS,GAAG;QAAEf,CAAC,EAAEiE,KAAK,CAACC,OAAO;QAAEjE,CAAC,EAAEgE,KAAK,CAACE;MAAO,CAAE;MACvD;IACF;IAEA,IAAI,CAAC,IAAI,CAACT,UAAU,EAAE;IACtB,MAAMU,IAAI,GAAG,IAAI,CAACV,UAAU,CAACL,aAAa,CAACgB,qBAAqB,EAAE;IAClE,MAAMrE,CAAC,GAAGiE,KAAK,CAACC,OAAO,GAAGE,IAAI,CAACE,IAAI;IACnC,MAAMrE,CAAC,GAAGgE,KAAK,CAACE,OAAO,GAAGC,IAAI,CAACG,GAAG;IAClC,MAAMC,QAAQ,GAAG;MAAExE,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACF,IAAI;MAAEG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACH;IAAI,CAAE;IAEvD,IAAI,IAAI,CAACtB,IAAI,KAAK,UAAU,EAAE;MAC5B,IAAI,CAACkC,SAAS,CAAC+D,IAAI,CAACD,QAAQ,CAAC;MAC7B,IAAI,CAACZ,aAAa,EAAE;MACpB;IACF;IAEA,IAAI,IAAI,CAACpF,IAAI,KAAK,MAAM,EAAE;MACxB,IAAI,CAACmC,KAAK,CAAC8D,IAAI,CAACD,QAAQ,CAAC;MACzB,IAAI,CAACZ,aAAa,EAAE;MACpB;IACF;IAEA,IAAI,IAAI,CAACpF,IAAI,KAAK,WAAW,EAAE;MAC7B,IAAI,CAAC4B,iBAAiB,CAACqE,IAAI,CAACD,QAAQ,CAAC;MACrC,IAAI,IAAI,CAACpE,iBAAiB,CAACsE,MAAM,KAAK,CAAC,EAAE;QACvC,IAAI,CAACC,iBAAiB,EAAE;MAC1B;MACA,IAAI,CAACf,aAAa,EAAE;MACpB;IACF;IAEA,IAAI,IAAI,CAACpF,IAAI,KAAK,OAAO,EAAE;MACzB,IAAI,CAAC0B,SAAS,GAAG,KAAK;MACtB,IAAI,CAACI,UAAU,GAAG,IAAI;MAEtB;MACA,IAAI2D,KAAK,CAACW,MAAM,IAAI,CAAC,EAAE;QACrB,IAAI,CAACC,iBAAiB,EAAE;QACxB;MACF;MAEA;MACA,IAAI,IAAI,CAACxE,WAAW,CAACqE,MAAM,KAAK,CAAC,EAAE;QACjC,IAAI,CAACrE,WAAW,GAAG,CAACmE,QAAQ,CAAC;MAC/B,CAAC,MAAM;QACL,IAAI,CAACnE,WAAW,GAAG,CAAC,GAAG,IAAI,CAACA,WAAW,EAAEmE,QAAQ,CAAC;MACpD;MACA,IAAI,CAACZ,aAAa,EAAE;MACpB;IACF;IAEA,IAAI,IAAI,CAACpF,IAAI,KAAK,SAAS,EAAE;MAC3B,IAAI,CAAC0B,SAAS,GAAG,KAAK;MACtB,MAAM4E,KAAK,GAAG,IAAI,CAACC,mBAAmB,CAACP,QAAQ,CAAC;MAChD,IAAI,CAAC,IAAI,CAAC5D,gBAAgB,EAAE;QAC1B,IAAIkE,KAAK,EAAE;UACT,IAAI,CAAClE,gBAAgB,GAAGkE,KAAK;UAC7B,IAAI,CAAClB,aAAa,EAAE;QACtB;QACA;MACF;MAEA;MACA,MAAMoB,GAAG,GAAG,IAAI,CAACD,mBAAmB,CAACP,QAAQ,EAAE,MAAM,CAAC;MACtD,IAAI,CAACQ,GAAG,EAAE;QACR,IAAI,CAACC,SAAS,CAAC,gDAAgD,CAAC;QAChE;MACF;MAEA;MACA,IAAI,IAAI,CAACrE,gBAAgB,CAACsE,IAAI,KAAK,UAAU,IAAIF,GAAG,CAACE,IAAI,KAAK,UAAU,EAAE;QACxE,IAAI,CAACD,SAAS,CAAC,qCAAqC,CAAC;QACrD;MACF;MAEA,MAAME,IAAI,GAAG,CAAC,IAAI,CAACvE,gBAAgB,CAACwE,KAAK,EAAEJ,GAAG,CAACI,KAAK,CAAC;MACrD,MAAMC,QAAQ,GAAG,IAAI,CAACC,WAAW,CAACH,IAAI,CAAC;MACvC,IAAI,CAAC5E,SAAS,CAACkE,IAAI,CAAC;QAAEc,MAAM,EAAEJ,IAAI;QAAEE,QAAQ;QAAEH,IAAI,EAAE;MAAS,CAAE,CAAC;MAChE,IAAI,CAACzE,gBAAgB,GAAG,IAAI,CAACF,SAAS,CAACiF,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACP,IAAI,KAAK,SAAS,CAAC,CAACQ,MAAM,CAAC,CAACC,GAAG,EAAEF,CAAC,KAAKE,GAAG,GAAGF,CAAC,CAACJ,QAAQ,EAAE,CAAC,CAAC;MAChH,IAAI,CAACzE,gBAAgB,GAAG,IAAI;MAC5B,IAAI,CAACgD,aAAa,EAAE;MACpB;IACF;IAEA;EACF;EAEAgC,WAAWA,CAAC3B,KAAiB;IAC3B,IAAI,IAAI,CAACzF,IAAI,KAAK,KAAK,EAAE;MACvB,IAAI,CAAC,IAAI,CAAC0B,SAAS,EAAE;MACrB,MAAM2F,EAAE,GAAG5B,KAAK,CAACC,OAAO,GAAG,IAAI,CAACnD,SAAS,CAACf,CAAC;MAC3C,MAAM8F,EAAE,GAAG7B,KAAK,CAACE,OAAO,GAAG,IAAI,CAACpD,SAAS,CAACd,CAAC;MAC3C,IAAI,CAACF,SAAS,CAACC,CAAC,IAAI6F,EAAE;MACtB,IAAI,CAAC9F,SAAS,CAACE,CAAC,IAAI6F,EAAE;MACtB,IAAI,CAAC/E,SAAS,GAAG;QAAEf,CAAC,EAAEiE,KAAK,CAACC,OAAO;QAAEjE,CAAC,EAAEgE,KAAK,CAACE;MAAO,CAAE;MACvD;IACF;IAEA,IAAI,IAAI,CAAC3F,IAAI,KAAK,OAAO,IAAI,IAAI,CAAC6B,WAAW,CAACqE,MAAM,GAAG,CAAC,IAAI,IAAI,CAAChB,UAAU,EAAE;MAC3E,MAAMU,IAAI,GAAG,IAAI,CAACV,UAAU,CAACL,aAAa,CAACgB,qBAAqB,EAAE;MAClE,MAAMrE,CAAC,GAAGiE,KAAK,CAACC,OAAO,GAAGE,IAAI,CAACE,IAAI;MACnC,MAAMrE,CAAC,GAAGgE,KAAK,CAACE,OAAO,GAAGC,IAAI,CAACG,GAAG;MAClC,IAAI,CAACjE,UAAU,GAAG;QAAEN,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACF,IAAI;QAAEG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACH;MAAI,CAAE;MACxD,IAAI,CAAC8D,aAAa,EAAE;IACtB;EACF;EAEAmC,SAASA,CAAA;IACP,IAAI,IAAI,CAACvH,IAAI,KAAK,KAAK,EAAE;MACvB,IAAI,CAAC0B,SAAS,GAAG,KAAK;MACtB;IACF;IAEA,IAAI,IAAI,CAAC1B,IAAI,KAAK,OAAO,IAAI,IAAI,CAACA,IAAI,KAAK,SAAS,EAAE;MACpD;MACA;IACF;EACF;EAEAwH,YAAYA,CAAA;IACV,OAAO,aAAa,IAAI,CAACjG,SAAS,CAACC,CAAC,OAAO,IAAI,CAACD,SAAS,CAACE,CAAC,KAAK;EAClE;EAEAgG,MAAMA,CAAA;IACJ,IAAI,CAACnG,IAAI,GAAGK,IAAI,CAAC+F,GAAG,CAAC,CAAC,EAAE,IAAI,CAACpG,IAAI,GAAG,GAAG,CAAC;IACxC,IAAI,CAAC2C,UAAU,EAAE;EACnB;EAEA0D,OAAOA,CAAA;IACL,IAAI,CAACrG,IAAI,GAAGK,IAAI,CAACiG,GAAG,CAAC,GAAG,EAAE,IAAI,CAACtG,IAAI,GAAG,GAAG,CAAC;IAC1C,IAAI,CAAC2C,UAAU,EAAE;EACnB;EAEAtE,OAAOA,CAACkI,IAAqE;IAC3E;IACA,IAAI,CAAC,IAAI,CAAC3H,iBAAiB,IAAI2H,IAAI,KAAK,WAAW,IAAIA,IAAI,KAAK,KAAK,EAAE;MACrE,IAAI,CAACpB,SAAS,CAAC,kCAAkC,CAAC;MAClD;IACF;IACA,IAAI,CAACzG,IAAI,GAAG6H,IAAI;IAChB,IAAI,CAACnG,SAAS,GAAG,KAAK;IACtB;IACA,IAAImG,IAAI,KAAK,OAAO,IAAIA,IAAI,KAAK,SAAS,IAAIA,IAAI,KAAK,KAAK,EAAE;MAC5D,IAAI,CAAChG,WAAW,GAAG,EAAE;MACrB,IAAI,CAACC,UAAU,GAAG,IAAI;IACxB;IACA,IAAI+F,IAAI,KAAK,SAAS,IAAIA,IAAI,KAAK,KAAK,EAAE;MACxC,IAAI,CAACzF,gBAAgB,GAAG,IAAI;IAC9B;IACA,IAAIyF,IAAI,KAAK,WAAW,EAAE;MACxB,IAAI,CAACjG,iBAAiB,GAAG,EAAE;IAC7B;IACA,IAAI,CAACwD,aAAa,EAAE;EACtB;EAEA0C,YAAYA,CAAA;IACV,IAAI,CAAC/F,SAAS,GAAG,EAAE;IACnB,IAAI,CAACF,WAAW,GAAG,EAAE;IACrB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACM,gBAAgB,GAAG,IAAI;IAC5B,IAAI,CAACtB,YAAY,GAAG,IAAI;IACxB,IAAI,CAACkB,eAAe,GAAG,CAAC;IACxB,IAAI,CAACC,gBAAgB,GAAG,CAAC;IACzB,IAAI,CAACL,iBAAiB,GAAG,EAAE;IAC3B,IAAI,CAACM,SAAS,GAAG,EAAE;IACnB,IAAI,CAACC,KAAK,GAAG,EAAE;IACf,IAAI,CAACiD,aAAa,EAAE;EACtB;EAEAhG,gBAAgBA,CAAA;IACd,MAAM2I,GAAG,GAAG,IAAI,CAACC,iBAAiB,EAAE;IACpCC,YAAY,CAACC,UAAU,CAACH,GAAG,CAAC;IAC5B,IAAI,CAAC7H,iBAAiB,GAAG,IAAI;IAC7B,IAAI,CAACuG,SAAS,CAAC,qBAAqB,CAAC;IACrC,IAAI,CAACrB,aAAa,EAAE;EACtB;EAEQ4C,iBAAiBA,CAAA;IACvB;IACA,OAAO,mBAAmB,IAAI,CAAC7G,MAAM,EAAE;EACzC;EAEQ+C,eAAeA,CAAA;IACrB,MAAM6D,GAAG,GAAG,IAAI,CAACC,iBAAiB,EAAE;IACpC,MAAMG,KAAK,GAAGF,YAAY,CAACG,OAAO,CAACL,GAAG,CAAC;IACvC,IAAII,KAAK,EAAE;MACT,IAAI;QACF,IAAI,CAACjI,iBAAiB,GAAGmI,UAAU,CAACF,KAAK,CAAC;QAC1C,IAAI,CAAC1B,SAAS,CAAC,oCAAoC,CAAC;QACpD,IAAI,CAACrB,aAAa,EAAE;MACtB,CAAC,CAAC,OAAOkD,CAAC,EAAE;QACVjF,OAAO,CAACC,KAAK,CAAC,6BAA6B,EAAEgF,CAAC,CAAC;MACjD;IACF;EACF;EAEQC,eAAeA,CAAA;IACrB,IAAI,IAAI,CAACrI,iBAAiB,KAAK,IAAI,EAAE;MACnC,MAAM6H,GAAG,GAAG,IAAI,CAACC,iBAAiB,EAAE;MACpCC,YAAY,CAACO,OAAO,CAACT,GAAG,EAAE,IAAI,CAAC7H,iBAAiB,CAACuI,QAAQ,EAAE,CAAC;IAC9D;EACF;EAEQtC,iBAAiBA,CAAA;IACvB,IAAI,IAAI,CAACvE,iBAAiB,CAACsE,MAAM,KAAK,CAAC,EAAE;IACzC,MAAM,CAACwC,EAAE,EAAEC,EAAE,CAAC,GAAG,IAAI,CAAC/G,iBAAiB;IACvC,MAAMyF,EAAE,GAAGsB,EAAE,CAACnH,CAAC,GAAGkH,EAAE,CAAClH,CAAC;IACtB,MAAM8F,EAAE,GAAGqB,EAAE,CAAClH,CAAC,GAAGiH,EAAE,CAACjH,CAAC;IACtB,MAAMmH,MAAM,GAAGjH,IAAI,CAACkH,IAAI,CAACxB,EAAE,GAAGA,EAAE,GAAGC,EAAE,GAAGA,EAAE,CAAC;IAC3C,MAAMwB,KAAK,GAAGC,MAAM,CAAC,kDAAkD,CAAC;IACxE,MAAMC,IAAI,GAAGF,KAAK,GAAGT,UAAU,CAACS,KAAK,CAAC,GAAGG,GAAG;IAC5C,IAAI,CAACC,KAAK,CAACF,IAAI,CAAC,IAAIJ,MAAM,GAAG,CAAC,EAAE;MAC9B,IAAI,CAAC1I,iBAAiB,GAAG8I,IAAI,GAAGJ,MAAM;MACtC,IAAI,CAACL,eAAe,EAAE;MACtB,IAAI,CAAC9B,SAAS,CAAC,mBAAmB,CAAC;IACrC,CAAC,MAAM;MACL,IAAI,CAACvG,iBAAiB,GAAG,IAAI;IAC/B;IACA,IAAI,CAAC0B,iBAAiB,GAAG,EAAE;EAC7B;EAEQkF,WAAWA,CAACH,IAAgC;IAClD,IAAIwC,EAAE,GAAG,CAAC;IACV,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGzC,IAAI,CAACT,MAAM,EAAEkD,CAAC,EAAE,EAAE;MACpC,MAAM/B,EAAE,GAAGV,IAAI,CAACyC,CAAC,CAAC,CAAC5H,CAAC,GAAGmF,IAAI,CAACyC,CAAC,GAAG,CAAC,CAAC,CAAC5H,CAAC;MACpC,MAAM8F,EAAE,GAAGX,IAAI,CAACyC,CAAC,CAAC,CAAC3H,CAAC,GAAGkF,IAAI,CAACyC,CAAC,GAAG,CAAC,CAAC,CAAC3H,CAAC;MACpC0H,EAAE,IAAIxH,IAAI,CAACkH,IAAI,CAACxB,EAAE,GAAGA,EAAE,GAAGC,EAAE,GAAGA,EAAE,CAAC;IACpC;IACA,IAAI,IAAI,CAACpH,iBAAiB,EAAE;MAC1B,OAAOiJ,EAAE,GAAG,IAAI,CAACjJ,iBAAiB;IACpC;IACA,OAAO,CAAC;EACV;EAEQmG,iBAAiBA,CAAA;IACvB,IAAI,CAAC,IAAI,CAACrG,IAAI,KAAK,OAAO,IAAI,IAAI,CAACA,IAAI,KAAK,SAAS,KAAK,IAAI,CAAC6B,WAAW,CAACqE,MAAM,GAAG,CAAC,EAAE;MACrF,MAAMW,QAAQ,GAAG,IAAI,CAACC,WAAW,CAAC,IAAI,CAACjF,WAAW,CAAC;MACnD,IAAI,CAACE,SAAS,CAACkE,IAAI,CAAC;QAAEc,MAAM,EAAE,CAAC,GAAG,IAAI,CAAClF,WAAW,CAAC;QAAEgF,QAAQ;QAAEH,IAAI,EAAE,IAAI,CAAC1G;MAAI,CAAE,CAAC;MACjF,IAAI,CAACgC,eAAe,GAAG,IAAI,CAACD,SAAS,CAACiF,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACP,IAAI,KAAK,OAAO,CAAC,CAACQ,MAAM,CAAC,CAACC,GAAG,EAAEF,CAAC,KAAKE,GAAG,GAAGF,CAAC,CAACJ,QAAQ,EAAE,CAAC,CAAC;MAC7G,IAAI,CAAC5E,gBAAgB,GAAG,IAAI,CAACF,SAAS,CAACiF,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACP,IAAI,KAAK,SAAS,CAAC,CAACQ,MAAM,CAAC,CAACC,GAAG,EAAEF,CAAC,KAAKE,GAAG,GAAGF,CAAC,CAACJ,QAAQ,EAAE,CAAC,CAAC;MAEhH,IAAI,IAAI,CAAC7G,IAAI,KAAK,OAAO,EAAE;QACzB,IAAI,CAACyG,SAAS,CAAC,sBAAsBI,QAAQ,CAACjG,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC;QAC9D,IAAI,CAAC6B,gBAAgB,CAAC4G,IAAI,CAAC,IAAI,CAACtH,SAAS,CAAC;MAC5C;IACF;IACA,IAAI,CAACF,WAAW,GAAG,EAAE;IACrB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACsD,aAAa,EAAE;EACtB;EAEA/E,SAASA,CAAA;IACP,IAAI,IAAI,CAACwB,WAAW,CAACqE,MAAM,GAAG,CAAC,EAAE;MAC/B,IAAI,CAACO,SAAS,CAAC,sCAAsC,CAAC;MACtD;IACF;IACA,MAAMI,QAAQ,GAAG,IAAI,CAACC,WAAW,CAAC,IAAI,CAACjF,WAAW,CAAC;IACnD,MAAMyH,QAAQ,GAAG;MAAEvC,MAAM,EAAE,CAAC,GAAG,IAAI,CAAClF,WAAW,CAAC;MAAEgF,QAAQ;MAAEH,IAAI,EAAE;IAAgB,CAAE;IACpF,IAAI,CAAC3E,SAAS,CAACkE,IAAI,CAACqD,QAAQ,CAAC;IAC7B,IAAI,CAACtH,eAAe,GAAG,IAAI,CAACD,SAAS,CAACiF,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACP,IAAI,KAAK,OAAO,CAAC,CAACQ,MAAM,CAAC,CAACC,GAAG,EAAEF,CAAC,KAAKE,GAAG,GAAGF,CAAC,CAACJ,QAAQ,EAAE,CAAC,CAAC;IAC7G,IAAI,CAACpE,gBAAgB,CAAC4G,IAAI,CAAC,IAAI,CAACtH,SAAS,CAAC;IAC1C,IAAI,CAAC0E,SAAS,CAAC,sBAAsBI,QAAQ,CAACjG,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC;IAC9D,IAAI,CAACiB,WAAW,GAAG,EAAE;IACrB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACsD,aAAa,EAAE;EACtB;EAEQA,aAAaA,CAAA;IACnB,IAAI,CAAC,IAAI,CAAC5C,UAAU,IAAI,CAAC,IAAI,CAAC0C,UAAU,EAAE;IAC1C,MAAMqE,GAAG,GAAG,IAAI,CAAC/G,UAAU;IAC3B,MAAM2C,OAAO,GAAG,IAAI,CAACD,UAAU,CAACL,aAAa;IAC7C0E,GAAG,CAACC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAErE,OAAO,CAACH,KAAK,EAAEG,OAAO,CAACF,MAAM,CAAC;IAElD;IACAsE,GAAG,CAACE,SAAS,GAAG,SAAS;IACzB,IAAI,CAAC7H,iBAAiB,CAAC8H,OAAO,CAACzC,CAAC,IAAG;MACjCsC,GAAG,CAACI,SAAS,EAAE;MACfJ,GAAG,CAACK,GAAG,CAAC3C,CAAC,CAACzF,CAAC,GAAG,IAAI,CAACF,IAAI,EAAE2F,CAAC,CAACxF,CAAC,GAAG,IAAI,CAACH,IAAI,EAAE,CAAC,EAAE,CAAC,EAAEK,IAAI,CAACkI,EAAE,GAAG,CAAC,CAAC;MAC5DN,GAAG,CAACO,IAAI,EAAE;IACZ,CAAC,CAAC;IAEF;IACA,IAAI,CAAC/H,SAAS,CAAC2H,OAAO,CAACK,IAAI,IAAG;MAC5B,IAAIA,IAAI,CAAChD,MAAM,CAACb,MAAM,GAAG,CAAC,EAAE;MAC5BqD,GAAG,CAACS,WAAW,GAAGD,IAAI,CAACrD,IAAI,KAAK,OAAO,GAAG,SAAS,GAAG,SAAS;MAC/D6C,GAAG,CAACU,SAAS,GAAG,CAAC;MACjBV,GAAG,CAACI,SAAS,EAAE;MACfJ,GAAG,CAACW,MAAM,CAACH,IAAI,CAAChD,MAAM,CAAC,CAAC,CAAC,CAACvF,CAAC,GAAG,IAAI,CAACF,IAAI,EAAEyI,IAAI,CAAChD,MAAM,CAAC,CAAC,CAAC,CAACtF,CAAC,GAAG,IAAI,CAACH,IAAI,CAAC;MACtE,KAAK,IAAI8H,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGW,IAAI,CAAChD,MAAM,CAACb,MAAM,EAAEkD,CAAC,EAAE,EAAE;QAC3CG,GAAG,CAACY,MAAM,CAACJ,IAAI,CAAChD,MAAM,CAACqC,CAAC,CAAC,CAAC5H,CAAC,GAAG,IAAI,CAACF,IAAI,EAAEyI,IAAI,CAAChD,MAAM,CAACqC,CAAC,CAAC,CAAC3H,CAAC,GAAG,IAAI,CAACH,IAAI,CAAC;MACxE;MACAiI,GAAG,CAACa,MAAM,EAAE;IACd,CAAC,CAAC;IAEF;IACA,IAAI,IAAI,CAACvI,WAAW,CAACqE,MAAM,GAAG,CAAC,EAAE;MAC/BqD,GAAG,CAACS,WAAW,GAAG,SAAS;MAC3BT,GAAG,CAACU,SAAS,GAAG,CAAC;MACjBV,GAAG,CAACc,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MACvBd,GAAG,CAACI,SAAS,EAAE;MACfJ,GAAG,CAACW,MAAM,CAAC,IAAI,CAACrI,WAAW,CAAC,CAAC,CAAC,CAACL,CAAC,GAAG,IAAI,CAACF,IAAI,EAAE,IAAI,CAACO,WAAW,CAAC,CAAC,CAAC,CAACJ,CAAC,GAAG,IAAI,CAACH,IAAI,CAAC;MAChF,KAAK,IAAI8H,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACvH,WAAW,CAACqE,MAAM,EAAEkD,CAAC,EAAE,EAAE;QAChDG,GAAG,CAACY,MAAM,CAAC,IAAI,CAACtI,WAAW,CAACuH,CAAC,CAAC,CAAC5H,CAAC,GAAG,IAAI,CAACF,IAAI,EAAE,IAAI,CAACO,WAAW,CAACuH,CAAC,CAAC,CAAC3H,CAAC,GAAG,IAAI,CAACH,IAAI,CAAC;MAClF;MAEA;MACA,IAAI,IAAI,CAACQ,UAAU,EAAE;QACnByH,GAAG,CAACY,MAAM,CAAC,IAAI,CAACrI,UAAU,CAACN,CAAC,GAAG,IAAI,CAACF,IAAI,EAAE,IAAI,CAACQ,UAAU,CAACL,CAAC,GAAG,IAAI,CAACH,IAAI,CAAC;MAC1E;MACAiI,GAAG,CAACa,MAAM,EAAE;MACZb,GAAG,CAACc,WAAW,CAAC,EAAE,CAAC;IACrB;IAEA;IACA,IAAI,IAAI,CAACjI,gBAAgB,EAAE;MACzBmH,GAAG,CAACS,WAAW,GAAG,SAAS;MAC3BT,GAAG,CAACU,SAAS,GAAG,CAAC;MACjBV,GAAG,CAACI,SAAS,EAAE;MACfJ,GAAG,CAACK,GAAG,CAAC,IAAI,CAACxH,gBAAgB,CAACwE,KAAK,CAACpF,CAAC,GAAG,IAAI,CAACF,IAAI,EAAE,IAAI,CAACc,gBAAgB,CAACwE,KAAK,CAACnF,CAAC,GAAG,IAAI,CAACH,IAAI,EAAE,EAAE,EAAE,CAAC,EAAEK,IAAI,CAACkI,EAAE,GAAG,CAAC,CAAC;MACjHN,GAAG,CAACa,MAAM,EAAE;IACd;IAEA;IACA,IAAI,CAAClI,SAAS,CAACwH,OAAO,CAACY,EAAE,IAAI,IAAI,CAACC,YAAY,CAACD,EAAE,CAAC,CAAC;IACnD,IAAI,CAACnI,KAAK,CAACuH,OAAO,CAACY,EAAE,IAAI,IAAI,CAACE,UAAU,CAACF,EAAE,EAAE,SAAS,CAAC,CAAC;EAC1D;EAEQ/D,mBAAmBA,CAACkE,MAAgC,EAAEC,YAAqB;IACjF,MAAMC,SAAS,GAAG,EAAE,GAAG,IAAI,CAACrJ,IAAI;IAChC,MAAMsJ,UAAU,GAAqE,EAAE;IACvF,IAAI,CAACF,YAAY,IAAIA,YAAY,KAAK,MAAM,EAAE;MAC5C,IAAI,CAACvI,KAAK,CAACuH,OAAO,CAACzC,CAAC,IAAI2D,UAAU,CAAC3E,IAAI,CAAC;QAAEW,KAAK,EAAEK,CAAC;QAAEP,IAAI,EAAE;MAAM,CAAE,CAAC,CAAC;IACtE;IACA,IAAI,CAACgE,YAAY,EAAE;MACjB,IAAI,CAACxI,SAAS,CAACwH,OAAO,CAACzC,CAAC,IAAI2D,UAAU,CAAC3E,IAAI,CAAC;QAAEW,KAAK,EAAEK,CAAC;QAAEP,IAAI,EAAE;MAAU,CAAE,CAAC,CAAC;IAC9E;IACA,IAAImE,OAAO,GAA0E,IAAI;IACzF,IAAIC,IAAI,GAAGC,MAAM,CAACC,SAAS;IAC3BJ,UAAU,CAAClB,OAAO,CAACuB,CAAC,IAAG;MACrB,MAAM5D,EAAE,GAAG4D,CAAC,CAACrE,KAAK,CAACpF,CAAC,GAAGiJ,MAAM,CAACjJ,CAAC;MAC/B,MAAM8F,EAAE,GAAG2D,CAAC,CAACrE,KAAK,CAACnF,CAAC,GAAGgJ,MAAM,CAAChJ,CAAC;MAC/B,MAAMyJ,IAAI,GAAGvJ,IAAI,CAACkH,IAAI,CAACxB,EAAE,GAAGA,EAAE,GAAGC,EAAE,GAAGA,EAAE,CAAC;MACzC,IAAI4D,IAAI,GAAGJ,IAAI,IAAII,IAAI,IAAIP,SAAS,EAAE;QACpCG,IAAI,GAAGI,IAAI;QACXL,OAAO,GAAGI,CAAC;MACb;IACF,CAAC,CAAC;IACF,OAAOJ,OAAO;EAChB;EAEQpE,SAASA,CAAC0E,OAAe;IAC/B,IAAI,CAACrK,YAAY,GAAGqK,OAAO;IAC3B,IAAI,IAAI,CAAC9I,UAAU,EAAE;MACnB+I,YAAY,CAAC,IAAI,CAAC/I,UAAU,CAAC;IAC/B;IACA,IAAI,CAACA,UAAU,GAAGgJ,UAAU,CAAC,MAAK;MAChC,IAAI,CAACvK,YAAY,GAAG,IAAI;IAC1B,CAAC,EAAE,IAAI,CAAC;EACV;EAEQyJ,YAAYA,CAACD,EAA4B;IAC/C,IAAI,CAAC,IAAI,CAAC9H,UAAU,EAAE;IACtB,MAAM8I,IAAI,GAAG,EAAE;IACf,MAAMrG,MAAM,GAAGqG,IAAI,GAAG3J,IAAI,CAACkH,IAAI,CAAC,CAAC,CAAC;IAClC,MAAM0C,OAAO,GAAGjB,EAAE,CAAC9I,CAAC,GAAG,IAAI,CAACF,IAAI;IAChC,MAAMkK,OAAO,GAAGlB,EAAE,CAAC7I,CAAC,GAAG,IAAI,CAACH,IAAI;IAChC,IAAI,CAACkB,UAAU,CAACiH,SAAS,GAAG,SAAS;IACrC,IAAI,CAACjH,UAAU,CAACwH,WAAW,GAAG,SAAS;IACvC,IAAI,CAACxH,UAAU,CAACyH,SAAS,GAAG,CAAC;IAC7B,IAAI,CAACzH,UAAU,CAACmH,SAAS,EAAE;IAC3B,IAAI,CAACnH,UAAU,CAAC0H,MAAM,CAACqB,OAAO,EAAEC,OAAO,GAAI,CAAC,GAAGvG,MAAM,GAAG,CAAE,CAAC;IAC3D,IAAI,CAACzC,UAAU,CAAC2H,MAAM,CAACoB,OAAO,GAAGD,IAAI,EAAEE,OAAO,GAAIvG,MAAM,GAAG,CAAE,CAAC;IAC9D,IAAI,CAACzC,UAAU,CAAC2H,MAAM,CAACoB,OAAO,GAAGD,IAAI,EAAEE,OAAO,GAAIvG,MAAM,GAAG,CAAE,CAAC;IAC9D,IAAI,CAACzC,UAAU,CAACiJ,SAAS,EAAE;IAC3B,IAAI,CAACjJ,UAAU,CAACsH,IAAI,EAAE;IACtB,IAAI,CAACtH,UAAU,CAAC4H,MAAM,EAAE;EAC1B;EAEQI,UAAUA,CAACF,EAA4B,EAAEoB,KAAa;IAC5D,IAAI,CAAC,IAAI,CAAClJ,UAAU,EAAE;IACtB,IAAI,CAACA,UAAU,CAACiH,SAAS,GAAGiC,KAAK;IACjC,IAAI,CAAClJ,UAAU,CAACwH,WAAW,GAAG,SAAS;IACvC,IAAI,CAACxH,UAAU,CAACyH,SAAS,GAAG,CAAC;IAC7B,IAAI,CAACzH,UAAU,CAACmH,SAAS,EAAE;IAC3B,IAAI,CAACnH,UAAU,CAACoH,GAAG,CAACU,EAAE,CAAC9I,CAAC,GAAG,IAAI,CAACF,IAAI,EAAEgJ,EAAE,CAAC7I,CAAC,GAAG,IAAI,CAACH,IAAI,EAAE,EAAE,EAAE,CAAC,EAAEK,IAAI,CAACkI,EAAE,GAAG,CAAC,CAAC;IAC3E,IAAI,CAACrH,UAAU,CAACsH,IAAI,EAAE;IACtB,IAAI,CAACtH,UAAU,CAAC4H,MAAM,EAAE;EAC1B;EAEAuB,QAAQA,CAAA;IACN,IAAI,IAAI,CAACvK,GAAG,IAAI,IAAI,CAACC,WAAW,GAAG,IAAI,CAACD,GAAG,CAACwK,QAAQ,EAAE;MACpD,IAAI,CAACvK,WAAW,EAAE;MAClB,IAAI,CAAC4C,UAAU,EAAE;IACnB;EACF;EAEA4H,QAAQA,CAAA;IACN,IAAI,IAAI,CAACzK,GAAG,IAAI,IAAI,CAACC,WAAW,GAAG,CAAC,EAAE;MACpC,IAAI,CAACA,WAAW,EAAE;MAClB,IAAI,CAAC4C,UAAU,EAAE;IACnB;EACF;;;uCA7fWhD,kBAAkB;IAAA;EAAA;;;YAAlBA,kBAAkB;MAAA6K,SAAA;MAAAC,SAAA,WAAAC,yBAAAC,EAAA,EAAA1C,GAAA;QAAA,IAAA0C,EAAA;;;;;;;;;;;;;;;;;;;;;;;UArGnBrN,EALR,CAAAC,cAAA,aAAyC,aAEuB,aAC1B,aACK,gBACoG;UAA/HD,EAAA,CAAAE,UAAA,mBAAAoN,oDAAA;YAAAtN,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAASkK,GAAA,CAAAsC,QAAA,EAAU;UAAA,EAAC;UAA2GjN,EAAA,CAAAW,MAAA,QAAI;UAAAX,EAAA,CAAAY,YAAA,EAAS;UACpJZ,EAAA,CAAAC,cAAA,cAAkD;UAAAD,EAAA,CAAAW,MAAA,GAAiD;UAAAX,EAAA,CAAAY,YAAA,EAAO;UAC1GZ,EAAA,CAAAC,cAAA,gBAA0J;UAAlJD,EAAA,CAAAE,UAAA,mBAAAsN,oDAAA;YAAAxN,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAASkK,GAAA,CAAAoC,QAAA,EAAU;UAAA,EAAC;UAA8H/M,EAAA,CAAAW,MAAA,QAAI;UAChKX,EADgK,CAAAY,YAAA,EAAS,EACnK;UAEJZ,EADF,CAAAC,cAAA,cAAqC,iBACiD;UAA5ED,EAAA,CAAAE,UAAA,mBAAAuN,qDAAA;YAAAzN,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAASkK,GAAA,CAAA5B,OAAA,EAAS;UAAA,EAAC;UAAyD/I,EAAA,CAAAW,MAAA,cAAC;UAAAX,EAAA,CAAAY,YAAA,EAAS;UAC9FZ,EAAA,CAAAC,cAAA,gBAAiD;UAAAD,EAAA,CAAAW,MAAA,IAA6B;UAAAX,EAAA,CAAAY,YAAA,EAAO;UACrFZ,EAAA,CAAAC,cAAA,iBAAmF;UAA3ED,EAAA,CAAAE,UAAA,mBAAAwN,qDAAA;YAAA1N,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAASkK,GAAA,CAAA9B,MAAA,EAAQ;UAAA,EAAC;UAAyD7I,EAAA,CAAAW,MAAA,SAAC;UACtFX,EADsF,CAAAY,YAAA,EAAS,EACzF;UACNZ,EAAA,CAAA2N,SAAA,eAA4B;UAC5B3N,EAAA,CAAAC,cAAA,kBAAuI;UAA/HD,EAAA,CAAAE,UAAA,mBAAA0N,qDAAA;YAAA5N,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAASkK,GAAA,CAAA5J,OAAA,CAAQ,KAAK,CAAC;UAAA,EAAC;UAAuGf,EAAA,CAAAW,MAAA,WAAG;UAAAX,EAAA,CAAAY,YAAA,EAAS;UAIjJZ,EADF,CAAAC,cAAA,eAAsB,kBAEiC;UAD7CD,EAAA,CAAAE,UAAA,mBAAA2N,qDAAA;YAAA7N,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAAAkK,GAAA,CAAAjK,mBAAA,IAAAiK,GAAA,CAAAjK,mBAAA;UAAA,EAAoD;UACPV,EAAA,CAAAW,MAAA,0BAAa;UAAAX,EAAA,CAAAY,YAAA,EAAS;UAC3EZ,EAAA,CAAAgB,UAAA,KAAA8M,kCAAA,kBAAyG;UAQ3G9N,EAAA,CAAAY,YAAA,EAAM;UACNZ,EAAA,CAAAC,cAAA,kBAImF;UAJ3ED,EAAA,CAAAE,UAAA,mBAAA6N,qDAAA;YAAA/N,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAASkK,GAAA,CAAA5J,OAAA,CAAQ,OAAO,CAAC;UAAA,EAAC;UAIiDf,EAAA,CAAAW,MAAA,kBAAU;UAAAX,EAAA,CAAAY,YAAA,EAAS;UACtGZ,EAAA,CAAAgB,UAAA,KAAAgN,qCAAA,qBAE8E;UAI5EhO,EADF,CAAAC,cAAA,eAAsB,kBAGiF;UAF7FD,EAAA,CAAAE,UAAA,mBAAA+N,qDAAA;YAAAjO,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAAAkK,GAAA,CAAA/I,iBAAA,IAAA+I,GAAA,CAAA/I,iBAAA;UAAA,EAAgD;UAE6C5B,EAAA,CAAAW,MAAA,wBAAW;UAAAX,EAAA,CAAAY,YAAA,EAAS;UACzHZ,EAAA,CAAAgB,UAAA,KAAAkN,kCAAA,mBAAuG;UAczGlO,EAAA,CAAAY,YAAA,EAAM;UACNZ,EAAA,CAAAC,cAAA,kBAAkE;UAA1DD,EAAA,CAAAE,UAAA,mBAAAiO,qDAAA;YAAAnO,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAASkK,GAAA,CAAAzB,YAAA,EAAc;UAAA,EAAC;UAAkClJ,EAAA,CAAAW,MAAA,aAAK;UACzEX,EADyE,CAAAY,YAAA,EAAS,EAC5E;UACNZ,EAAA,CAAAC,cAAA,eAAkE;UAEhED,EADA,CAAAgB,UAAA,KAAAoN,kCAAA,kBAAgC,KAAAC,kCAAA,kBACD;UAC/BrO,EAAA,CAAAC,cAAA,WAAK;UAAAD,EAAA,CAAAW,MAAA,IAAgD;UAAAX,EAAA,CAAAY,YAAA,EAAM;UAC3DZ,EAAA,CAAAC,cAAA,WAAK;UAAAD,EAAA,CAAAW,MAAA,IAAmD;UAAAX,EAAA,CAAAY,YAAA,EAAM;UAC9DZ,EAAA,CAAAC,cAAA,WAAK;UAAAD,EAAA,CAAAW,MAAA,IAAmE;UAE5EX,EAF4E,CAAAY,YAAA,EAAM,EAC1E,EACF;UAGNZ,EAAA,CAAAC,cAAA,eAMC;UADCD,EAHA,CAAAE,UAAA,uBAAAoO,sDAAAC,MAAA;YAAAvO,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CAAakK,GAAA,CAAA/D,WAAA,CAAA2H,MAAA,CAAmB;UAAA,EAAC,uBAAAC,sDAAAD,MAAA;YAAAvO,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CACpBkK,GAAA,CAAAnC,WAAA,CAAA+F,MAAA,CAAmB;UAAA,EAAC,qBAAAE,oDAAA;YAAAzO,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CACtBkK,GAAA,CAAAhC,SAAA,EAAW;UAAA,EAAC,wBAAA+F,uDAAA;YAAA1O,EAAA,CAAAI,aAAA,CAAAmN,GAAA;YAAA,OAAAvN,EAAA,CAAAS,WAAA,CACTkK,GAAA,CAAAhC,SAAA,EAAW;UAAA,EAAC;UAE1B3I,EAAA,CAAAC,cAAA,kBAKC;UAECD,EADA,CAAA2N,SAAA,qBAAoG,qBAK1F;UACZ3N,EAAA,CAAAY,YAAA,EAAM;UAENZ,EAAA,CAAAgB,UAAA,KAAA2N,kCAAA,kBAAuJ;UAI3J3O,EADE,CAAAY,YAAA,EAAM,EACF;;;UA3F+BZ,EAAA,CAAAkB,SAAA,GAA6B;UAA7BlB,EAAA,CAAAqB,UAAA,aAAAsJ,GAAA,CAAAlI,WAAA,MAA6B;UACRzC,EAAA,CAAAkB,SAAA,GAAiD;UAAjDlB,EAAA,CAAA+B,kBAAA,UAAA4I,GAAA,CAAAlI,WAAA,UAAAkI,GAAA,CAAAnI,GAAA,kBAAAmI,GAAA,CAAAnI,GAAA,CAAAwK,QAAA,OAAiD;UACtEhN,EAAA,CAAAkB,SAAA,EAAgD;UAAhDlB,EAAA,CAAAqB,UAAA,aAAAsJ,GAAA,CAAAlI,WAAA,MAAAkI,GAAA,CAAAnI,GAAA,kBAAAmI,GAAA,CAAAnI,GAAA,CAAAwK,QAAA,QAAgD;UAI5BhN,EAAA,CAAAkB,SAAA,GAA6B;UAA7BlB,EAAA,CAAAiC,kBAAA,KAAA0I,GAAA,CAAA5H,IAAA,CAAA6L,KAAA,CAAAjE,GAAA,CAAAjI,IAAA,aAA6B;UAI/C1C,EAAA,CAAAkB,SAAA,GAAkC;UAAClB,EAAnC,CAAAmB,WAAA,gBAAAwJ,GAAA,CAAAvJ,IAAA,WAAkC,eAAAuJ,GAAA,CAAAvJ,IAAA,WAAkC;UAM7FpB,EAAA,CAAAkB,SAAA,GAAyB;UAAzBlB,EAAA,CAAAqB,UAAA,SAAAsJ,GAAA,CAAAjK,mBAAA,CAAyB;UAW/BV,EAAA,CAAAkB,SAAA,EAAoC;UACpClB,EADA,CAAAmB,WAAA,gBAAAwJ,GAAA,CAAAvJ,IAAA,aAAoC,eAAAuJ,GAAA,CAAAvJ,IAAA,aACD;UAFnCpB,EAAA,CAAAqB,UAAA,cAAAsJ,GAAA,CAAArJ,iBAAA,CAA+B;UAK9BtB,EAAA,CAAAkB,SAAA,GAA4B;UAA5BlB,EAAA,CAAAqB,UAAA,SAAAsJ,GAAA,CAAA1H,WAAA,CAAAqE,MAAA,KAA4B;UAM3BtH,EAAA,CAAAkB,SAAA,GAA+B;UAA/BlB,EAAA,CAAAqB,UAAA,cAAAsJ,GAAA,CAAArJ,iBAAA,CAA+B;UAE3BtB,EAAA,CAAAkB,SAAA,GAAuB;UAAvBlB,EAAA,CAAAqB,UAAA,SAAAsJ,GAAA,CAAA/I,iBAAA,CAAuB;UAkBzB5B,EAAA,CAAAkB,SAAA,GAAwB;UAAxBlB,EAAA,CAAAqB,UAAA,UAAAsJ,GAAA,CAAArJ,iBAAA,CAAwB;UACxBtB,EAAA,CAAAkB,SAAA,EAAuB;UAAvBlB,EAAA,CAAAqB,UAAA,SAAAsJ,GAAA,CAAArJ,iBAAA,CAAuB;UACxBtB,EAAA,CAAAkB,SAAA,GAAgD;UAAhDlB,EAAA,CAAAiC,kBAAA,kBAAA0I,GAAA,CAAAvH,eAAA,CAAApB,OAAA,WAAgD;UAChDhC,EAAA,CAAAkB,SAAA,GAAmD;UAAnDlB,EAAA,CAAAiC,kBAAA,oBAAA0I,GAAA,CAAAtH,gBAAA,CAAArB,OAAA,WAAmD;UACnDhC,EAAA,CAAAkB,SAAA,GAAmE;UAAnElB,EAAA,CAAA+B,kBAAA,cAAA4I,GAAA,CAAArH,SAAA,CAAAgE,MAAA,kBAAAqD,GAAA,CAAApH,KAAA,CAAA+D,MAAA,WAAmE;UAexEtH,EAAA,CAAAkB,SAAA,GAAkC;UAClClB,EADA,CAAA6O,WAAA,cAAAlE,GAAA,CAAA/B,YAAA,GAAkC,wBAAA+B,GAAA,CAAA7H,SAAA,mBACsB;UAEd9C,EAAA,CAAAkB,SAAA,GAAgD;UAAhDlB,EAAA,CAAA6O,WAAA,WAAAlE,GAAA,CAAA7H,SAAA,uBAAgD;UAIxF9C,EAAA,CAAAkB,SAAA,GAAwG;UAAxGlB,EAAA,CAAA6O,WAAA,WAAAlE,GAAA,CAAAvJ,IAAA,gBAAAuJ,GAAA,CAAAvJ,IAAA,kBAAAuJ,GAAA,CAAAvJ,IAAA,wCAAwG;UAItGpB,EAAA,CAAAkB,SAAA,GAAkB;UAAlBlB,EAAA,CAAAqB,UAAA,SAAAsJ,GAAA,CAAAzI,YAAA,CAAkB;;;qBA9FpBpC,YAAY,EAAAgP,EAAA,CAAAC,IAAA;MAAAC,MAAA;IAAA;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}