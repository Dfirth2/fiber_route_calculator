{"ast":null,"code":"import _asyncToGenerator from \"/home/dfirth2/fiber_route_calculator/frontend-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CommonModule } from '@angular/common';\nimport * as pdfjsLib from 'pdfjs-dist';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = [\"pdfCanvas\"];\nconst _c1 = [\"wrapper\"];\nconst _c2 = [\"overlayCanvas\"];\nfunction PDFViewerComponent_div_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Calibrate: click two points on scale, enter real feet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PDFViewerComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\"Scale: \", (ctx_r1.scaleFeetPerPixel * 12).toFixed(4), \" inches/px (\", ctx_r1.scaleFeetPerPixel.toFixed(4), \" ft/px)\");\n  }\n}\npdfjsLib.GlobalWorkerOptions.workerSrc = '/assets/pdf.worker.min.mjs';\nexport class PDFViewerComponent {\n  constructor() {\n    this.pdfUrl = '';\n    this.pdf = null;\n    this.currentPage = 1;\n    this.zoom = 1;\n    this.panOffset = {\n      x: 0,\n      y: 0\n    };\n    this.isPanning = false;\n    this.Math = Math;\n    this.mode = 'pan';\n    this.calibrationPoints = [];\n    this.scaleFeetPerPixel = null;\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.polylines = [];\n    this.totalLengthFeet = 0;\n    this.totalConduitFeet = 0;\n    this.terminals = [];\n    this.drops = [];\n    this.renderTask = null;\n    this.lastMouse = {\n      x: 0,\n      y: 0\n    };\n    this.overlayCtx = null;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (_this.pdfUrl) {\n        yield _this.loadPdf();\n      }\n    })();\n  }\n  ngOnChanges(changes) {\n    if (changes['pdfUrl'] && !changes['pdfUrl'].firstChange && this.pdfUrl) {\n      this.loadPdf();\n    }\n  }\n  loadPdf() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this2.pdfUrl) return;\n      try {\n        const response = yield fetch(_this2.pdfUrl);\n        if (!response.ok) {\n          console.error('Failed to fetch PDF:', response.status, response.statusText);\n          return;\n        }\n        const blob = yield response.blob();\n        const buffer = yield blob.arrayBuffer();\n        const typedArray = new Uint8Array(buffer);\n        _this2.pdf = yield pdfjsLib.getDocument({\n          data: typedArray\n        }).promise;\n        _this2.currentPage = 1;\n        _this2.panOffset = {\n          x: 0,\n          y: 0\n        };\n        yield _this2.renderPage();\n      } catch (error) {\n        console.error('Error loading PDF:', error);\n      }\n    })();\n  }\n  renderPage() {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this3.pdf || !_this3.canvasRef) return;\n      if (_this3.renderTask) {\n        try {\n          _this3.renderTask.cancel();\n        } catch (err) {}\n      }\n      try {\n        const page = yield _this3.pdf.getPage(_this3.currentPage);\n        const viewport = page.getViewport({\n          scale: _this3.zoom\n        });\n        const canvas = _this3.canvasRef.nativeElement;\n        const context = canvas.getContext('2d');\n        if (!context) return;\n        canvas.width = viewport.width;\n        canvas.height = viewport.height;\n        // keep overlay in sync\n        if (_this3.overlayRef) {\n          const overlay = _this3.overlayRef.nativeElement;\n          overlay.width = viewport.width;\n          overlay.height = viewport.height;\n          _this3.overlayCtx = overlay.getContext('2d');\n          _this3.redrawOverlay();\n        }\n        const renderContext = {\n          canvasContext: context,\n          viewport\n        };\n        _this3.renderTask = page.render(renderContext);\n        yield _this3.renderTask.promise;\n      } catch (error) {\n        console.error('Render error:', error);\n      }\n    })();\n  }\n  onMouseDown(event) {\n    if (this.mode === 'pan') {\n      this.isPanning = true;\n      this.lastMouse = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      return;\n    }\n    if (!this.overlayRef) return;\n    const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    const pdfPoint = {\n      x: x / this.zoom,\n      y: y / this.zoom\n    };\n    if (this.mode === 'terminal') {\n      this.terminals.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n    if (this.mode === 'drop') {\n      this.drops.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n    if (this.mode === 'calibrate') {\n      this.calibrationPoints.push(pdfPoint);\n      if (this.calibrationPoints.length === 2) {\n        this.finishCalibration();\n      }\n      this.redrawOverlay();\n      return;\n    }\n    if (this.mode === 'fiber' || this.mode === 'conduit') {\n      this.isPanning = false;\n      this.hoverPoint = null;\n      if (this.drawingPath.length === 0) {\n        this.drawingPath = [pdfPoint];\n      } else {\n        this.drawingPath = [...this.drawingPath, pdfPoint];\n      }\n      // Double-click (detail >= 2) commits the segment\n      if (event.detail >= 2) {\n        this.commitDrawingPath();\n      } else {\n        this.redrawOverlay();\n      }\n    }\n  }\n  onMouseMove(event) {\n    if (this.mode === 'pan') {\n      if (!this.isPanning) return;\n      const dx = event.clientX - this.lastMouse.x;\n      const dy = event.clientY - this.lastMouse.y;\n      this.panOffset.x += dx;\n      this.panOffset.y += dy;\n      this.lastMouse = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      return;\n    }\n    if ((this.mode === 'fiber' || this.mode === 'conduit') && this.drawingPath.length > 0 && this.overlayRef) {\n      const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      this.hoverPoint = {\n        x: x / this.zoom,\n        y: y / this.zoom\n      };\n      this.redrawOverlay();\n    }\n  }\n  onMouseUp() {\n    if (this.mode === 'pan') {\n      this.isPanning = false;\n      return;\n    }\n    if (this.mode === 'fiber' || this.mode === 'conduit') {\n      // Mouse up ends panning only; path commit happens on double-click\n      return;\n    }\n  }\n  getTransform() {\n    return `translate(${this.panOffset.x}px, ${this.panOffset.y}px)`;\n  }\n  zoomIn() {\n    this.zoom = Math.min(3, this.zoom * 1.2);\n    this.renderPage();\n  }\n  zoomOut() {\n    this.zoom = Math.max(0.5, this.zoom / 1.2);\n    this.renderPage();\n  }\n  setMode(next) {\n    this.mode = next;\n    this.isPanning = false;\n    if (next !== 'fiber' && next !== 'conduit') {\n      this.drawingPath = [];\n      this.hoverPoint = null;\n    }\n    if (next !== 'calibrate') {\n      this.calibrationPoints = [];\n    }\n    this.redrawOverlay();\n  }\n  clearOverlay() {\n    this.polylines = [];\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.totalLengthFeet = 0;\n    this.totalConduitFeet = 0;\n    this.calibrationPoints = [];\n    this.terminals = [];\n    this.drops = [];\n    this.redrawOverlay();\n  }\n  finishCalibration() {\n    if (this.calibrationPoints.length !== 2) return;\n    const [p1, p2] = this.calibrationPoints;\n    const dx = p2.x - p1.x;\n    const dy = p2.y - p1.y;\n    const distPx = Math.sqrt(dx * dx + dy * dy);\n    const input = prompt('Enter real-world distance between points (feet):');\n    const feet = input ? parseFloat(input) : NaN;\n    if (!isNaN(feet) && distPx > 0) {\n      this.scaleFeetPerPixel = feet / distPx;\n    } else {\n      this.scaleFeetPerPixel = null;\n    }\n    this.calibrationPoints = [];\n  }\n  measurePath(path) {\n    let px = 0;\n    for (let i = 1; i < path.length; i++) {\n      const dx = path[i].x - path[i - 1].x;\n      const dy = path[i].y - path[i - 1].y;\n      px += Math.sqrt(dx * dx + dy * dy);\n    }\n    if (this.scaleFeetPerPixel) {\n      return px * this.scaleFeetPerPixel;\n    }\n    return 0;\n  }\n  commitDrawingPath() {\n    if ((this.mode === 'fiber' || this.mode === 'conduit') && this.drawingPath.length > 1) {\n      const lengthFt = this.measurePath(this.drawingPath);\n      this.polylines.push({\n        points: [...this.drawingPath],\n        lengthFt,\n        type: this.mode\n      });\n      this.totalLengthFeet = this.polylines.filter(p => p.type === 'fiber').reduce((sum, p) => sum + p.lengthFt, 0);\n      this.totalConduitFeet = this.polylines.filter(p => p.type === 'conduit').reduce((sum, p) => sum + p.lengthFt, 0);\n    }\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.redrawOverlay();\n  }\n  redrawOverlay() {\n    if (!this.overlayCtx || !this.overlayRef) return;\n    const ctx = this.overlayCtx;\n    const overlay = this.overlayRef.nativeElement;\n    ctx.clearRect(0, 0, overlay.width, overlay.height);\n    // calibration points\n    ctx.fillStyle = '#f97316';\n    this.calibrationPoints.forEach(p => {\n      ctx.beginPath();\n      ctx.arc(p.x * this.zoom, p.y * this.zoom, 5, 0, Math.PI * 2);\n      ctx.fill();\n    });\n    // polylines\n    this.polylines.forEach(line => {\n      if (line.points.length < 2) return;\n      ctx.strokeStyle = line.type === 'fiber' ? '#2563eb' : '#9333ea';\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      ctx.moveTo(line.points[0].x * this.zoom, line.points[0].y * this.zoom);\n      for (let i = 1; i < line.points.length; i++) {\n        ctx.lineTo(line.points[i].x * this.zoom, line.points[i].y * this.zoom);\n      }\n      ctx.stroke();\n    });\n    // current drawing\n    if (this.drawingPath.length > 0) {\n      ctx.strokeStyle = '#10b981';\n      ctx.lineWidth = 2;\n      ctx.setLineDash([6, 4]);\n      ctx.beginPath();\n      ctx.moveTo(this.drawingPath[0].x * this.zoom, this.drawingPath[0].y * this.zoom);\n      for (let i = 1; i < this.drawingPath.length; i++) {\n        ctx.lineTo(this.drawingPath[i].x * this.zoom, this.drawingPath[i].y * this.zoom);\n      }\n      // preview to hover point while placing vertices\n      if (this.hoverPoint) {\n        ctx.lineTo(this.hoverPoint.x * this.zoom, this.hoverPoint.y * this.zoom);\n      }\n      ctx.stroke();\n      ctx.setLineDash([]);\n    }\n    // markers\n    this.terminals.forEach(pt => this.drawMarker(pt, '#10b981'));\n    this.drops.forEach(pt => this.drawMarker(pt, '#f59e0b'));\n  }\n  drawMarker(pt, color) {\n    if (!this.overlayCtx) return;\n    this.overlayCtx.fillStyle = color;\n    this.overlayCtx.strokeStyle = '#ffffff';\n    this.overlayCtx.lineWidth = 2;\n    this.overlayCtx.beginPath();\n    this.overlayCtx.arc(pt.x * this.zoom, pt.y * this.zoom, 8, 0, Math.PI * 2);\n    this.overlayCtx.fill();\n    this.overlayCtx.stroke();\n  }\n  nextPage() {\n    if (this.pdf && this.currentPage < this.pdf.numPages) {\n      this.currentPage++;\n      this.renderPage();\n    }\n  }\n  prevPage() {\n    if (this.pdf && this.currentPage > 1) {\n      this.currentPage--;\n      this.renderPage();\n    }\n  }\n  static {\n    this.ɵfac = function PDFViewerComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || PDFViewerComponent)();\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PDFViewerComponent,\n      selectors: [[\"app-pdf-viewer\"]],\n      viewQuery: function PDFViewerComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5)(_c1, 5)(_c2, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.wrapperRef = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.overlayRef = _t.first);\n        }\n      },\n      inputs: {\n        pdfUrl: \"pdfUrl\"\n      },\n      features: [i0.ɵɵNgOnChangesFeature],\n      decls: 50,\n      vars: 43,\n      consts: [[\"wrapper\", \"\"], [\"pdfCanvas\", \"\"], [\"overlayCanvas\", \"\"], [1, \"relative\", \"bg-gray-100\", \"flex-1\", \"overflow-hidden\", \"flex\", \"items-center\", \"justify-center\", 3, \"mousedown\", \"mousemove\", \"mouseup\", \"mouseleave\"], [1, \"transition-transform\"], [1, \"bg-white\", \"block\"], [1, \"absolute\", \"inset-0\", \"pointer-events-auto\"], [1, \"absolute\", \"top-4\", \"left-4\", \"right-4\", \"flex\", \"flex-wrap\", \"items-start\", \"justify-between\", \"gap-3\", \"pointer-events-auto\"], [1, \"bg-white\", \"p-2\", \"rounded\", \"shadow\", \"flex\", \"flex-col\", \"gap-2\"], [1, \"flex\", \"gap-1\"], [1, \"px-3\", \"py-1\", \"bg-gray-200\", \"rounded\", \"hover:bg-gray-300\", \"disabled:opacity-50\", 3, \"click\", \"disabled\"], [1, \"px-3\", \"py-1\", \"text-sm\", \"whitespace-nowrap\"], [1, \"px-3\", \"py-1\", \"bg-gray-200\", \"rounded\", \"hover:bg-gray-300\", 3, \"click\"], [1, \"px-3\", \"py-1\", \"text-sm\", \"w-16\", \"text-center\"], [1, \"text-xs\", \"text-gray-600\", \"text-center\"], [1, \"bg-white/95\", \"backdrop-blur\", \"p-3\", \"rounded\", \"shadow\", \"flex\", \"flex-col\", \"gap-2\", \"w-full\", \"md:w-auto\", \"max-w-3xl\"], [1, \"flex\", \"flex-wrap\", \"gap-2\"], [1, \"px-3\", \"py-1\", \"rounded\", \"border\", 3, \"click\"], [1, \"text-xs\", \"text-gray-700\", \"flex\", \"flex-wrap\", \"gap-x-4\", \"gap-y-1\"], [4, \"ngIf\"]],\n      template: function PDFViewerComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 3);\n          i0.ɵɵlistener(\"mousedown\", function PDFViewerComponent_Template_div_mousedown_0_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseDown($event));\n          })(\"mousemove\", function PDFViewerComponent_Template_div_mousemove_0_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseMove($event));\n          })(\"mouseup\", function PDFViewerComponent_Template_div_mouseup_0_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseUp());\n          })(\"mouseleave\", function PDFViewerComponent_Template_div_mouseleave_0_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onMouseUp());\n          });\n          i0.ɵɵelementStart(1, \"div\", 4, 0);\n          i0.ɵɵelement(3, \"canvas\", 5, 1)(5, \"canvas\", 6, 2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"div\", 7)(8, \"div\", 8)(9, \"div\", 9)(10, \"button\", 10);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_10_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.prevPage());\n          });\n          i0.ɵɵtext(11, \"<\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"span\", 11);\n          i0.ɵɵtext(13);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(14, \"button\", 10);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_14_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.nextPage());\n          });\n          i0.ɵɵtext(15, \">\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(16, \"div\", 9)(17, \"button\", 12);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_17_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.zoomOut());\n          });\n          i0.ɵɵtext(18, \"\\u2212\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"span\", 13);\n          i0.ɵɵtext(20);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"button\", 12);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_21_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.zoomIn());\n          });\n          i0.ɵɵtext(22, \"+\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(23, \"div\", 14);\n          i0.ɵɵtext(24, \"Drag to pan\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(25, \"div\", 15)(26, \"div\", 16)(27, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_27_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"pan\"));\n          });\n          i0.ɵɵtext(28, \"Pan\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(29, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_29_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"calibrate\"));\n          });\n          i0.ɵɵtext(30, \"Calibrate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_31_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"fiber\"));\n          });\n          i0.ɵɵtext(32, \"Draw Fiber\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(33, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_33_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"conduit\"));\n          });\n          i0.ɵɵtext(34, \"Draw Conduit\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(35, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_35_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"terminal\"));\n          });\n          i0.ɵɵtext(36, \"Terminal\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(37, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_37_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.setMode(\"drop\"));\n          });\n          i0.ɵɵtext(38, \"Drop Ped\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(39, \"button\", 17);\n          i0.ɵɵlistener(\"click\", function PDFViewerComponent_Template_button_click_39_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.clearOverlay());\n          });\n          i0.ɵɵtext(40, \"Clear\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(41, \"div\", 18);\n          i0.ɵɵtemplate(42, PDFViewerComponent_div_42_Template, 2, 0, \"div\", 19)(43, PDFViewerComponent_div_43_Template, 2, 2, \"div\", 19);\n          i0.ɵɵelementStart(44, \"div\");\n          i0.ɵɵtext(45);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(46, \"div\");\n          i0.ɵɵtext(47);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(48, \"div\");\n          i0.ɵɵtext(49);\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵstyleProp(\"transform\", ctx.getTransform())(\"transition-duration\", ctx.isPanning ? \"0ms\" : \"100ms\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵstyleProp(\"cursor\", ctx.isPanning ? \"grabbing\" : \"grab\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵstyleProp(\"cursor\", ctx.mode === \"fiber\" || ctx.mode === \"conduit\" || ctx.mode === \"calibrate\" ? \"crosshair\" : \"auto\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"disabled\", ctx.currentPage <= 1);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate2(\"Page \", ctx.currentPage, \" / \", (ctx.pdf == null ? null : ctx.pdf.numPages) || 1);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"disabled\", ctx.currentPage >= ((ctx.pdf == null ? null : ctx.pdf.numPages) || 1));\n          i0.ɵɵadvance(6);\n          i0.ɵɵtextInterpolate1(\"\", ctx.Math.round(ctx.zoom * 100), \"%\");\n          i0.ɵɵadvance(7);\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"pan\")(\"text-white\", ctx.mode === \"pan\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"calibrate\")(\"text-white\", ctx.mode === \"calibrate\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"fiber\")(\"text-white\", ctx.mode === \"fiber\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"conduit\")(\"text-white\", ctx.mode === \"conduit\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"terminal\")(\"text-white\", ctx.mode === \"terminal\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-blue-600\", ctx.mode === \"drop\")(\"text-white\", ctx.mode === \"drop\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", !ctx.scaleFeetPerPixel);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.scaleFeetPerPixel);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\"Fiber total: \", ctx.totalLengthFeet.toFixed(1), \" ft\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\"Conduit total: \", ctx.totalConduitFeet.toFixed(1), \" ft\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate2(\"Markers: \", ctx.terminals.length, \" terminals, \", ctx.drops.length, \" drops\");\n        }\n      },\n      dependencies: [CommonModule, i1.NgIf],\n      styles: [\"[_nghost-%COMP%] {\\n      display: flex;\\n      height: 100%;\\n      width: 100%;\\n    }\\n  \\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9wZGYtdmlld2VyL3BkZi12aWV3ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7SUFDSTtNQUNFLGFBQWE7TUFDYixZQUFZO01BQ1osV0FBVztJQUNiIiwic291cmNlc0NvbnRlbnQiOlsiXG4gICAgOmhvc3Qge1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgIH1cbiAgIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["CommonModule","pdfjsLib","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate2","ctx_r1","scaleFeetPerPixel","toFixed","GlobalWorkerOptions","workerSrc","PDFViewerComponent","constructor","pdfUrl","pdf","currentPage","zoom","panOffset","x","y","isPanning","Math","mode","calibrationPoints","drawingPath","hoverPoint","polylines","totalLengthFeet","totalConduitFeet","terminals","drops","renderTask","lastMouse","overlayCtx","ngOnInit","_this","_asyncToGenerator","loadPdf","ngOnChanges","changes","firstChange","_this2","response","fetch","ok","console","error","status","statusText","blob","buffer","arrayBuffer","typedArray","Uint8Array","getDocument","data","promise","renderPage","_this3","canvasRef","cancel","err","page","getPage","viewport","getViewport","scale","canvas","nativeElement","context","getContext","width","height","overlayRef","overlay","redrawOverlay","renderContext","canvasContext","render","onMouseDown","event","clientX","clientY","rect","getBoundingClientRect","left","top","pdfPoint","push","length","finishCalibration","detail","commitDrawingPath","onMouseMove","dx","dy","onMouseUp","getTransform","zoomIn","min","zoomOut","max","setMode","next","clearOverlay","p1","p2","distPx","sqrt","input","prompt","feet","parseFloat","NaN","isNaN","measurePath","path","px","i","lengthFt","points","type","filter","p","reduce","sum","ctx","clearRect","fillStyle","forEach","beginPath","arc","PI","fill","line","strokeStyle","lineWidth","moveTo","lineTo","stroke","setLineDash","pt","drawMarker","color","nextPage","numPages","prevPage","selectors","viewQuery","PDFViewerComponent_Query","rf","ɵɵlistener","PDFViewerComponent_Template_div_mousedown_0_listener","$event","ɵɵrestoreView","_r1","ɵɵresetView","PDFViewerComponent_Template_div_mousemove_0_listener","PDFViewerComponent_Template_div_mouseup_0_listener","PDFViewerComponent_Template_div_mouseleave_0_listener","ɵɵelement","PDFViewerComponent_Template_button_click_10_listener","PDFViewerComponent_Template_button_click_14_listener","PDFViewerComponent_Template_button_click_17_listener","PDFViewerComponent_Template_button_click_21_listener","PDFViewerComponent_Template_button_click_27_listener","PDFViewerComponent_Template_button_click_29_listener","PDFViewerComponent_Template_button_click_31_listener","PDFViewerComponent_Template_button_click_33_listener","PDFViewerComponent_Template_button_click_35_listener","PDFViewerComponent_Template_button_click_37_listener","PDFViewerComponent_Template_button_click_39_listener","ɵɵtemplate","PDFViewerComponent_div_42_Template","PDFViewerComponent_div_43_Template","ɵɵstyleProp","ɵɵproperty","ɵɵtextInterpolate1","round","ɵɵclassProp","i1","NgIf","styles"],"sources":["/home/dfirth2/fiber_route_calculator/frontend-angular/src/app/components/pdf-viewer/pdf-viewer.component.ts"],"sourcesContent":["import { Component, Input, OnChanges, OnInit, SimpleChanges, ViewChild, ElementRef } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as pdfjsLib from 'pdfjs-dist';\n\npdfjsLib.GlobalWorkerOptions.workerSrc = '/assets/pdf.worker.min.mjs';\n\n@Component({\n  selector: 'app-pdf-viewer',\n  standalone: true,\n  imports: [CommonModule],\n  template: `\n    <div\n      class=\"relative bg-gray-100 flex-1 overflow-hidden flex items-center justify-center\"\n      (mousedown)=\"onMouseDown($event)\"\n      (mousemove)=\"onMouseMove($event)\"\n      (mouseup)=\"onMouseUp()\"\n      (mouseleave)=\"onMouseUp()\"\n    >\n      <div\n        #wrapper\n        class=\"transition-transform\"\n        [style.transform]=\"getTransform()\"\n        [style.transitionDuration]=\"isPanning ? '0ms' : '100ms'\"\n      >\n        <canvas #pdfCanvas class=\"bg-white block\" [style.cursor]=\"isPanning ? 'grabbing' : 'grab'\"></canvas>\n        <canvas\n          #overlayCanvas\n          class=\"absolute inset-0 pointer-events-auto\"\n          [style.cursor]=\"(mode === 'fiber' || mode === 'conduit' || mode === 'calibrate') ? 'crosshair' : 'auto'\"\n        ></canvas>\n      </div>\n\n      <div class=\"absolute top-4 left-4 right-4 flex flex-wrap items-start justify-between gap-3 pointer-events-auto\">\n        <div class=\"bg-white p-2 rounded shadow flex flex-col gap-2\">\n          <div class=\"flex gap-1\">\n            <button (click)=\"prevPage()\" [disabled]=\"currentPage <= 1\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50\">&lt;</button>\n            <span class=\"px-3 py-1 text-sm whitespace-nowrap\">Page {{ currentPage }} / {{ pdf?.numPages || 1 }}</span>\n            <button (click)=\"nextPage()\" [disabled]=\"currentPage >= (pdf?.numPages || 1)\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50\">&gt;</button>\n          </div>\n          <div class=\"flex gap-1\">\n            <button (click)=\"zoomOut()\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300\">−</button>\n            <span class=\"px-3 py-1 text-sm w-16 text-center\">{{ Math.round(zoom * 100) }}%</span>\n            <button (click)=\"zoomIn()\" class=\"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300\">+</button>\n          </div>\n          <div class=\"text-xs text-gray-600 text-center\">Drag to pan</div>\n        </div>\n\n        <div class=\"bg-white/95 backdrop-blur p-3 rounded shadow flex flex-col gap-2 w-full md:w-auto max-w-3xl\">\n          <div class=\"flex flex-wrap gap-2\">\n            <button (click)=\"setMode('pan')\" [class.bg-blue-600]=\"mode==='pan'\" [class.text-white]=\"mode==='pan'\" class=\"px-3 py-1 rounded border\">Pan</button>\n            <button (click)=\"setMode('calibrate')\" [class.bg-blue-600]=\"mode==='calibrate'\" [class.text-white]=\"mode==='calibrate'\" class=\"px-3 py-1 rounded border\">Calibrate</button>\n            <button (click)=\"setMode('fiber')\" [class.bg-blue-600]=\"mode==='fiber'\" [class.text-white]=\"mode==='fiber'\" class=\"px-3 py-1 rounded border\">Draw Fiber</button>\n            <button (click)=\"setMode('conduit')\" [class.bg-blue-600]=\"mode==='conduit'\" [class.text-white]=\"mode==='conduit'\" class=\"px-3 py-1 rounded border\">Draw Conduit</button>\n            <button (click)=\"setMode('terminal')\" [class.bg-blue-600]=\"mode==='terminal'\" [class.text-white]=\"mode==='terminal'\" class=\"px-3 py-1 rounded border\">Terminal</button>\n            <button (click)=\"setMode('drop')\" [class.bg-blue-600]=\"mode==='drop'\" [class.text-white]=\"mode==='drop'\" class=\"px-3 py-1 rounded border\">Drop Ped</button>\n            <button (click)=\"clearOverlay()\" class=\"px-3 py-1 rounded border\">Clear</button>\n          </div>\n          <div class=\"text-xs text-gray-700 flex flex-wrap gap-x-4 gap-y-1\">\n            <div *ngIf=\"!scaleFeetPerPixel\">Calibrate: click two points on scale, enter real feet.</div>\n            <div *ngIf=\"scaleFeetPerPixel\">Scale: {{ (scaleFeetPerPixel*12).toFixed(4) }} inches/px ({{ (scaleFeetPerPixel).toFixed(4) }} ft/px)</div>\n            <div>Fiber total: {{ totalLengthFeet.toFixed(1) }} ft</div>\n            <div>Conduit total: {{ totalConduitFeet.toFixed(1) }} ft</div>\n            <div>Markers: {{ terminals.length }} terminals, {{ drops.length }} drops</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `,\n  styles: [`\n    :host {\n      display: flex;\n      height: 100%;\n      width: 100%;\n    }\n  `]\n})\nexport class PDFViewerComponent implements OnInit, OnChanges {\n  @ViewChild('pdfCanvas') canvasRef!: ElementRef<HTMLCanvasElement>;\n  @ViewChild('wrapper') wrapperRef!: ElementRef<HTMLDivElement>;\n  @ViewChild('overlayCanvas') overlayRef!: ElementRef<HTMLCanvasElement>;\n  @Input() pdfUrl: string = '';\n\n  pdf: any = null;\n  currentPage = 1;\n  zoom = 1;\n  panOffset = { x: 0, y: 0 };\n  isPanning = false;\n  Math = Math;\n\n  mode: 'pan' | 'calibrate' | 'fiber' | 'conduit' | 'terminal' | 'drop' = 'pan';\n  calibrationPoints: { x: number; y: number }[] = [];\n  scaleFeetPerPixel: number | null = null;\n  drawingPath: { x: number; y: number }[] = [];\n  hoverPoint: { x: number; y: number } | null = null;\n  polylines: { points: { x: number; y: number }[]; lengthFt: number; type: 'fiber' | 'conduit' }[] = [];\n  totalLengthFeet = 0;\n  totalConduitFeet = 0;\n  terminals: { x: number; y: number }[] = [];\n  drops: { x: number; y: number }[] = [];\n\n  private renderTask: any = null;\n  private lastMouse = { x: 0, y: 0 };\n  private overlayCtx: CanvasRenderingContext2D | null = null;\n\n  async ngOnInit() {\n    if (this.pdfUrl) {\n      await this.loadPdf();\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes['pdfUrl'] && !changes['pdfUrl'].firstChange && this.pdfUrl) {\n      this.loadPdf();\n    }\n  }\n\n  async loadPdf() {\n    if (!this.pdfUrl) return;\n    try {\n      const response = await fetch(this.pdfUrl);\n      if (!response.ok) {\n        console.error('Failed to fetch PDF:', response.status, response.statusText);\n        return;\n      }\n      const blob = await response.blob();\n      const buffer = await blob.arrayBuffer();\n      const typedArray = new Uint8Array(buffer);\n      this.pdf = await pdfjsLib.getDocument({ data: typedArray }).promise;\n      this.currentPage = 1;\n      this.panOffset = { x: 0, y: 0 };\n      await this.renderPage();\n    } catch (error) {\n      console.error('Error loading PDF:', error);\n    }\n  }\n\n  async renderPage() {\n    if (!this.pdf || !this.canvasRef) return;\n\n    if (this.renderTask) {\n      try {\n        this.renderTask.cancel();\n      } catch (err) {}\n    }\n\n    try {\n      const page = await this.pdf.getPage(this.currentPage);\n      const viewport = page.getViewport({ scale: this.zoom });\n\n      const canvas = this.canvasRef.nativeElement;\n      const context = canvas.getContext('2d');\n      if (!context) return;\n\n      canvas.width = viewport.width;\n      canvas.height = viewport.height;\n\n      // keep overlay in sync\n      if (this.overlayRef) {\n        const overlay = this.overlayRef.nativeElement;\n        overlay.width = viewport.width;\n        overlay.height = viewport.height;\n        this.overlayCtx = overlay.getContext('2d');\n        this.redrawOverlay();\n      }\n\n      const renderContext = { canvasContext: context, viewport };\n      this.renderTask = page.render(renderContext);\n      await this.renderTask.promise;\n    } catch (error) {\n      console.error('Render error:', error);\n    }\n  }\n\n  onMouseDown(event: MouseEvent) {\n    if (this.mode === 'pan') {\n      this.isPanning = true;\n      this.lastMouse = { x: event.clientX, y: event.clientY };\n      return;\n    }\n\n    if (!this.overlayRef) return;\n    const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n    const pdfPoint = { x: x / this.zoom, y: y / this.zoom };\n\n    if (this.mode === 'terminal') {\n      this.terminals.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n\n    if (this.mode === 'drop') {\n      this.drops.push(pdfPoint);\n      this.redrawOverlay();\n      return;\n    }\n\n    if (this.mode === 'calibrate') {\n      this.calibrationPoints.push(pdfPoint);\n      if (this.calibrationPoints.length === 2) {\n        this.finishCalibration();\n      }\n      this.redrawOverlay();\n      return;\n    }\n\n    if (this.mode === 'fiber' || this.mode === 'conduit') {\n      this.isPanning = false;\n      this.hoverPoint = null;\n      if (this.drawingPath.length === 0) {\n        this.drawingPath = [pdfPoint];\n      } else {\n        this.drawingPath = [...this.drawingPath, pdfPoint];\n      }\n\n      // Double-click (detail >= 2) commits the segment\n      if (event.detail >= 2) {\n        this.commitDrawingPath();\n      } else {\n        this.redrawOverlay();\n      }\n    }\n  }\n\n  onMouseMove(event: MouseEvent) {\n    if (this.mode === 'pan') {\n      if (!this.isPanning) return;\n      const dx = event.clientX - this.lastMouse.x;\n      const dy = event.clientY - this.lastMouse.y;\n      this.panOffset.x += dx;\n      this.panOffset.y += dy;\n      this.lastMouse = { x: event.clientX, y: event.clientY };\n      return;\n    }\n\n    if ((this.mode === 'fiber' || this.mode === 'conduit') && this.drawingPath.length > 0 && this.overlayRef) {\n      const rect = this.overlayRef.nativeElement.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      this.hoverPoint = { x: x / this.zoom, y: y / this.zoom };\n      this.redrawOverlay();\n    }\n  }\n\n  onMouseUp() {\n    if (this.mode === 'pan') {\n      this.isPanning = false;\n      return;\n    }\n\n    if (this.mode === 'fiber' || this.mode === 'conduit') {\n      // Mouse up ends panning only; path commit happens on double-click\n      return;\n    }\n  }\n\n  getTransform(): string {\n    return `translate(${this.panOffset.x}px, ${this.panOffset.y}px)`;\n  }\n\n  zoomIn() {\n    this.zoom = Math.min(3, this.zoom * 1.2);\n    this.renderPage();\n  }\n\n  zoomOut() {\n    this.zoom = Math.max(0.5, this.zoom / 1.2);\n    this.renderPage();\n  }\n\n  setMode(next: 'pan' | 'calibrate' | 'fiber' | 'conduit' | 'terminal' | 'drop') {\n    this.mode = next;\n    this.isPanning = false;\n    if (next !== 'fiber' && next !== 'conduit') {\n      this.drawingPath = [];\n      this.hoverPoint = null;\n    }\n    if (next !== 'calibrate') {\n      this.calibrationPoints = [];\n    }\n    this.redrawOverlay();\n  }\n\n  clearOverlay() {\n    this.polylines = [];\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.totalLengthFeet = 0;\n    this.totalConduitFeet = 0;\n    this.calibrationPoints = [];\n    this.terminals = [];\n    this.drops = [];\n    this.redrawOverlay();\n  }\n\n  private finishCalibration() {\n    if (this.calibrationPoints.length !== 2) return;\n    const [p1, p2] = this.calibrationPoints;\n    const dx = p2.x - p1.x;\n    const dy = p2.y - p1.y;\n    const distPx = Math.sqrt(dx * dx + dy * dy);\n    const input = prompt('Enter real-world distance between points (feet):');\n    const feet = input ? parseFloat(input) : NaN;\n    if (!isNaN(feet) && distPx > 0) {\n      this.scaleFeetPerPixel = feet / distPx;\n    } else {\n      this.scaleFeetPerPixel = null;\n    }\n    this.calibrationPoints = [];\n  }\n\n  private measurePath(path: { x: number; y: number }[]): number {\n    let px = 0;\n    for (let i = 1; i < path.length; i++) {\n      const dx = path[i].x - path[i - 1].x;\n      const dy = path[i].y - path[i - 1].y;\n      px += Math.sqrt(dx * dx + dy * dy);\n    }\n    if (this.scaleFeetPerPixel) {\n      return px * this.scaleFeetPerPixel;\n    }\n    return 0;\n  }\n\n  private commitDrawingPath() {\n    if ((this.mode === 'fiber' || this.mode === 'conduit') && this.drawingPath.length > 1) {\n      const lengthFt = this.measurePath(this.drawingPath);\n      this.polylines.push({ points: [...this.drawingPath], lengthFt, type: this.mode });\n      this.totalLengthFeet = this.polylines.filter(p => p.type === 'fiber').reduce((sum, p) => sum + p.lengthFt, 0);\n      this.totalConduitFeet = this.polylines.filter(p => p.type === 'conduit').reduce((sum, p) => sum + p.lengthFt, 0);\n    }\n    this.drawingPath = [];\n    this.hoverPoint = null;\n    this.redrawOverlay();\n  }\n\n  private redrawOverlay() {\n    if (!this.overlayCtx || !this.overlayRef) return;\n    const ctx = this.overlayCtx;\n    const overlay = this.overlayRef.nativeElement;\n    ctx.clearRect(0, 0, overlay.width, overlay.height);\n\n    // calibration points\n    ctx.fillStyle = '#f97316';\n    this.calibrationPoints.forEach(p => {\n      ctx.beginPath();\n      ctx.arc(p.x * this.zoom, p.y * this.zoom, 5, 0, Math.PI * 2);\n      ctx.fill();\n    });\n\n    // polylines\n    this.polylines.forEach(line => {\n      if (line.points.length < 2) return;\n      ctx.strokeStyle = line.type === 'fiber' ? '#2563eb' : '#9333ea';\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      ctx.moveTo(line.points[0].x * this.zoom, line.points[0].y * this.zoom);\n      for (let i = 1; i < line.points.length; i++) {\n        ctx.lineTo(line.points[i].x * this.zoom, line.points[i].y * this.zoom);\n      }\n      ctx.stroke();\n    });\n\n    // current drawing\n    if (this.drawingPath.length > 0) {\n      ctx.strokeStyle = '#10b981';\n      ctx.lineWidth = 2;\n      ctx.setLineDash([6, 4]);\n      ctx.beginPath();\n      ctx.moveTo(this.drawingPath[0].x * this.zoom, this.drawingPath[0].y * this.zoom);\n      for (let i = 1; i < this.drawingPath.length; i++) {\n        ctx.lineTo(this.drawingPath[i].x * this.zoom, this.drawingPath[i].y * this.zoom);\n      }\n\n      // preview to hover point while placing vertices\n      if (this.hoverPoint) {\n        ctx.lineTo(this.hoverPoint.x * this.zoom, this.hoverPoint.y * this.zoom);\n      }\n      ctx.stroke();\n      ctx.setLineDash([]);\n    }\n\n    // markers\n    this.terminals.forEach(pt => this.drawMarker(pt, '#10b981'));\n    this.drops.forEach(pt => this.drawMarker(pt, '#f59e0b'));\n  }\n\n  private drawMarker(pt: { x: number; y: number }, color: string) {\n    if (!this.overlayCtx) return;\n    this.overlayCtx.fillStyle = color;\n    this.overlayCtx.strokeStyle = '#ffffff';\n    this.overlayCtx.lineWidth = 2;\n    this.overlayCtx.beginPath();\n    this.overlayCtx.arc(pt.x * this.zoom, pt.y * this.zoom, 8, 0, Math.PI * 2);\n    this.overlayCtx.fill();\n    this.overlayCtx.stroke();\n  }\n\n  nextPage() {\n    if (this.pdf && this.currentPage < this.pdf.numPages) {\n      this.currentPage++;\n      this.renderPage();\n    }\n  }\n\n  prevPage() {\n    if (this.pdf && this.currentPage > 1) {\n      this.currentPage--;\n      this.renderPage();\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}